!function(e){function t(t){for(var n,s,i=t[0],c=t[1],l=t[2],d=0,m=[];d<i.length;d++)s=i[d],o[s]&&m.push(o[s][0]),o[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(u&&u(t);m.length;)m.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,i=1;i<a.length;i++){var c=a[i];0!==o[c]&&(n=!1)}n&&(r.splice(t--,1),e=s(s.s=a[0]))}return e}var n={},o={0:0},r=[];function s(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=n,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="./";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;r.push(["Vtdi",1]),a()}({"+Ajr":function(e,t,a){"use strict";var n=a("20Ks");a.n(n).a},"12/b":function(e,t,a){},"1fcz":function(e,t,a){},"20Ks":function(e,t,a){},"3VuB":function(e,t,a){"use strict";var n=a("FUVo");a.n(n).a},"5Nyv":function(e,t,a){"use strict";var n=a("9bYS");a.n(n).a},"9bYS":function(e,t,a){},"9qtH":function(e,t,a){},FUVo:function(e,t,a){},JQmY:function(e,t,a){},Kmra:function(e,t,a){"use strict";var n=a("1fcz");a.n(n).a},Knie:function(e,t,a){},OITN:function(e,t,a){"use strict";var n=a("12/b");a.n(n).a},OTLk:function(e,t,a){},OmPH:function(e,t,a){"use strict";var n=a("OTLk");a.n(n).a},QPUi:function(e,t,a){},RnhZ:function(e,t,a){var n={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function o(e){var t=r(e);return a(t)}function r(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=r,e.exports=o,o.id="RnhZ"},RyYm:function(e,t,a){},"U/FI":function(e,t,a){"use strict";var n=a("QPUi");a.n(n).a},Vtdi:function(e,t,a){"use strict";a.r(t);a("27D/");var n=a("oCYn"),o=a("jE9Z"),r=a("L2JU"),s={name:"Logs",data:function(){return{showDeleteDialog:!1,logIndexToDelete:null,deleteSelectedMapFeature:!1,mapFeatureSelected:!1}},props:["useGeolocation"],computed:Object(r.b)({logs:function(e){return e.farm.logs},areas:function(e){return e.farm.areas},assets:function(e){return e.farm.assets},currentLogIndex:function(e){return e.farm.currentLogIndex},statusText:function(e){return e.farm.statusText},photoLoc:function(e){return e.farm.photoLoc},geolocation:function(e){return e.farm.geolocation},localArea:function(e){return e.farm.localArea},units:function(e){return e.farm.units},userId:function(e){return e.shell.user.uid},categories:function(e){return e.farm.categories},equipment:function(e){return e.farm.equipment},logDisplayFilters:function(e){return e.shell.settings.logDisplayFilters}}),created:function(){this.$store.dispatch("onLogsComponentCreated"),this.$store.commit("clearDisplayFilters"),this.$store.dispatch("loadCachedDisplayFilters")},beforeDestroy:function(){this.$store.commit("clearLogs")},methods:{openDeleteDialog:function(e){this.showDeleteDialog=!0,this.logIndexToDelete=e},cancelDelete:function(){this.showDeleteDialog=!1},confirmDelete:function(){var e=this.logs[this.logIndexToDelete],t={index:this.logIndexToDelete,local_id:e.local_id,id:e.id,remoteUri:e.remoteUri,name:e.name.data,type:e.type.data};this.$store.commit("deleteLog",t),this.showDeleteDialog=!1,"edit-log"===this.$route.name&&this.$router.push({path:"/logs"})},syncAll:function(){this.$store.dispatch("getLogs")}}},i=(a("nldY"),a("KHd+")),c=Object(i.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("router-view",{attrs:{name:"menubar",logs:e.logs,currentLogIndex:e.currentLogIndex,mapFeatureSelected:e.mapFeatureSelected},on:{toggleDrawer:function(t){return e.$emit("toggleDrawer")},deleteCurrentLog:function(t){return e.openDeleteDialog(e.currentLogIndex)},deleteSelectedMapFeature:function(t){e.deleteSelectedMapFeature=!0},syncAll:e.syncAll}}),e._v(" "),a("router-view",{attrs:{logs:e.logs,areas:e.areas,assets:e.assets,currentLogIndex:e.currentLogIndex,photoLoc:e.photoLoc,geolocation:e.geolocation,localArea:e.localArea,useGeolocation:e.useGeolocation,units:e.units,categories:e.categories,equipment:e.equipment,userId:e.userId,logDisplayFilters:e.logDisplayFilters,deleteSelectedMapFeature:e.deleteSelectedMapFeature},on:{deleteLog:function(t){return e.openDeleteDialog(t)},mapFeatureSelected:function(t){return e.mapFeatureSelected=t},"delete-features":function(t){e.deleteSelectedMapFeature=!1,e.mapFeatureSelected=!1}}}),e._v(" "),e.showDeleteDialog?a("div",{staticClass:"modal",attrs:{id:"delete-dialog",tabindex:"-1",role:"dialog"}},[a("div",{staticClass:"modal-filter"}),e._v(" "),a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[e._v("Confirm Deletion")]),e._v(" "),a("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:e.cancelDelete}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])])]),e._v(" "),a("div",{staticClass:"modal-body"},[e._v("\n          Are sure you'd like to delete the log \""+e._s(e.logs[e.logIndexToDelete].name.data)+'"? \n          '),e.logs[e.logIndexToDelete].wasPushedToServer?a("span",[e._v("\n            Deleting it on this device will not remove the log from the server.\n          ")]):a("span",[e._v("\n            It has not yet been synced to the server and cannot be recovered after it's deleted.\n          ")])]),e._v(" "),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:e.cancelDelete}},[e._v("\n          Cancel\n        ")]),e._v(" "),a("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:function(t){return e.confirmDelete()}}},[e._v("\n          Delete\n        ")])])])])]):e._e()],1)},[],!1,null,"24a407ff",null).exports,l=a("wd/R"),u=a.n(l),d=Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),t("path",{attrs:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"}})])},[],!1,null,null,null).exports,m=Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),t("path",{attrs:{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"}})])},[],!1,null,null,null).exports,h=Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),t("path",{attrs:{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm-2 14l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"}})])},[],!1,null,null,null).exports,g=Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),t("path",{attrs:{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-6 15h-2v-2h2v2zm0-4h-2V8h2v6zm-1-9c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"}})])},[],!1,null,null,null).exports,p=Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),t("path",{attrs:{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM10 17l-3.5-3.5 1.41-1.41L10 14.17 15.18 9l1.41 1.41L10 17z"}})])},[],!1,null,null,null).exports,f=Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),t("path",{attrs:{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"}})])},[],!1,null,null,null).exports,v=Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}}),t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}})])},[],!1,null,null,null).exports,y={props:["logs","userId","assets","logDisplayFilters","areas"],components:{IconAddCircle:d,IconAssignment:m,IconAssignmentDone:h,IconAssignmentLate:g,IconCloudDone:p,IconCloudUpload:f,IconDelete:v,IconEdit:Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}}),t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}})])},[],!1,null,null,null).exports,IconSync:Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"}}),t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}})])},[],!1,null,null,null).exports},beforeRouteLeave:function(e,t,a){"edit-log"===e.name&&"number"==typeof e.params.index?(this.$store.commit("setCurrentLogIndex",e.params.index),a()):"edit-log"===e.name?(this.$store.dispatch("initializeLog",e.params.type),a()):a()},methods:{showDate:function(e){return u.a.unix(e).format("MMM DD YYYY")},mapTidsToAreas:function(e){var t=this;return e.area&&this.areas.length>0?e.area.data.map(function(e){return t.areas.find(function(t){return+t.tid==+e.id})}):[]},mapIdsToAssets:function(e){var t=this;return e.asset&&this.assets.length>0?e.asset.data.map(function(e){return t.assets.find(function(t){return+t.id==+e.id})}):[]},getLogType:function(e){return function(e){switch(e){case"farm_activity":return"Activity";case"farm_harvest":return"Harvest";case"farm_input":return"Input";case"farm_observation":return"Observation";case"farm_seeding":return"Seeding";default:throw new Error("Invalid type")}}(e)},passesFilters:function(e){var t,a,n,o=this;return!(this.logDisplayFilters.excludeTypes.includes(e.type.data)||0===e.log_category.data.length&&o.logDisplayFilters.excludeCategories.includes(-1)||e.log_category.data.some(function(e){return o.logDisplayFilters.excludeCategories.some(function(t){return+t==+e.id})})||(t=o.logDisplayFilters.date,a=new Date,n=void 0,"TODAY"===t&&(a.setDate(a.getDate()-1),n=a.valueOf()/1e3|0),"THIS_WEEK"===t&&(a.setDate(a.getDate()-7),n=a.valueOf()/1e3|0),"THIS_MONTH"===t&&(a.setMonth(a.getMonth()-1),n=a.valueOf()/1e3|0),"THIS_YEAR"===t&&(a.setYear(a.getYear()-1),n=a.valueOf()/1e3|0),"ALL_TIME"===t&&(n=0),!(e.timestamp.data>n)))}}},_=(a("j3JQ"),Object(i.a)(y,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"card-group"},[e.logs.length<1?a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("h4",{staticClass:"card-title"},[e._v("Let's Get Started!")]),e._v(" "),a("p",{staticClass:"card-text"},[e._v("\n          You don't have any logs to display yet. Logs are records of events\n          in farmOS. You can add some by clicking the "),a("IconAddCircle",{staticClass:"inline-svg"}),e._v("\n          icon below, or you can get uncompleted tasks from the server by\n          clicking the "),a("IconCloudUpload",{staticClass:"inline-svg"}),e._v(" icon above.\n        ")],1)])]):e._e(),e._v(" "),e._l(e.logs,function(t,n){return e.logs.length>0&&e.passesFilters(t)?a("div",{key:"card-"+e.logs.indexOf(t),staticClass:"card"},[a("router-link",{attrs:{to:{name:"edit-log",params:{index:n,type:t.type.data}}}},[a("div",{staticClass:"card-body"},[a("div",{staticClass:"card-row-1"},[t.done.data?a("icon-assignment-done",{staticClass:"assignment done"}):e._e(),e._v(" "),!t.done.data&&1e3*t.timestamp.data>(new Date).valueOf()?a("icon-assignment",{staticClass:"assignment"}):e._e(),e._v(" "),!t.done.data&&1e3*t.timestamp.data<(new Date).valueOf()?a("icon-assignment-late",{staticClass:"assignment late"}):e._e(),e._v(" "),a("div",{staticClass:"log-name"},[a("h5",[e._v(e._s(t.name.data))])]),e._v(" "),t.wasPushedToServer?a("icon-cloud-done",{staticClass:"sync-status"}):t.isReadyToSync?a("div",{staticClass:"spin sync-status",attrs:{"aria-hidden":"true"}},[a("icon-sync")],1):a("icon-cloud-upload",{staticClass:"sync-status"})],1),e._v(" "),a("div",{staticClass:"card-row-2"},[a("p",[e._v(e._s(t.notes.data))])]),e._v(" "),a("div",{staticClass:"card-row-3"},[a("div",{staticClass:"date-and-type"},[a("span",{staticClass:"log-type"},[e._v(e._s(e.getLogType(t.type.data).toUpperCase()))]),e._v(" "),a("span",[e._v(e._s(e.showDate(t.timestamp.data)))])]),e._v(" "),a("div",{staticClass:"tags"},[e._l(e.mapTidsToAreas(t),function(t){return a("span",{staticClass:"tag tag-area"},[e._v("\n                "+e._s(t.name)+"\n              ")])}),e._v(" "),e._l(e.mapIdsToAssets(t),function(t){return a("span",{staticClass:"tag tag-asset"},[e._v("\n                "+e._s(t.name)+"\n              ")])})],2)])])])],1):e._e()})],2),e._v(" "),a("router-link",{attrs:{to:{name:"edit-log",params:{type:"farm_observation"}}}},[a("div",{staticClass:"add-circle",on:{click:function(e){}}},[a("div",{staticClass:"background-circle"}),e._v(" "),a("icon-add-circle")],1)])],1)},[],!1,null,"5d5f9f3e",null).exports),C={name:"MenuBar",components:{IconMoreVert:Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),t("path",{attrs:{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}})])},[],!1,null,null,null).exports},props:{more:{type:Boolean,default:!0}},data:function(){return{showMore:!1}},methods:{openMoreMenu:function(e){e.stopPropagation(),this.showMore=!0,document.addEventListener("click",this.handleClickOutside)},handleClickOutside:function(e){var t=document.getElementById("more-menu");null===t||t.contains(e.target)||(this.showMore=!1)}},destroyed:function(){document.removeEventListener("click",this.handleClickOutside)}},w=(a("U/FI"),Object(i.a)(C,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("header",{staticClass:"navbar navbar-light fixed-top"},[a("ul",{staticClass:"left-menu"},[e._t("left-menu")],2),e._v(" "),a("ul",{staticClass:"right-menu"},[e._t("right-menu"),e._v(" "),e.more?a("li",{attrs:{id:"more-trigger"},on:{click:e.openMoreMenu}},[a("icon-more-vert")],1):e._e()],2),e._v(" "),e.showMore?a("ul",{attrs:{id:"more-menu"}},[e._t("more-menu")],2):e._e()])},[],!1,null,"3b110032",null).exports),b=Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{staticStyle:{"enable-background":"new 0 0 512 512"},attrs:{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 512 512",width:"24",height:"24","xml:space":"preserve"}},[t("polygon",{attrs:{points:"222.949,302.964 222.949,512 289.051,467.933 289.051,302.964 \t\t"}}),this._v(" "),t("rect",{attrs:{x:"2.612",width:"506.776",height:"49.576"}}),this._v(" "),t("polygon",{attrs:{points:"19.137,82.627 206.424,269.913 305.576,269.913 492.863,82.627 \t\t"}})])},[],!1,null,null,null).exports,L=Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),t("path",{attrs:{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}})])},[],!1,null,null,null).exports,x={name:"AllLogsMenuBar",components:{MenuBar:w,IconCloudUpload:f,IconFilter:b,IconMenu:L}},k=(a("3VuB"),Object(i.a)(x,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("menu-bar",{scopedSlots:e._u([{key:"left-menu",fn:function(){return[a("li",{on:{click:function(t){return e.$emit("toggleDrawer")}}},[a("icon-menu")],1),e._v(" "),a("li",[e._v("My Logs")])]},proxy:!0},{key:"right-menu",fn:function(){return[a("router-link",{staticClass:"filter",attrs:{to:{name:"filter-logs"},tag:"li"}},[a("icon-filter")],1),e._v(" "),a("li",{on:{click:function(t){return e.$emit("syncAll")}}},[a("icon-cloud-upload")],1)]},proxy:!0},{key:"more-menu",fn:function(){return[a("li",{on:{click:function(t){return e.$emit("syncAll")}}},[e._v("Sync all logs")]),e._v(" "),a("router-link",{staticClass:"filter",attrs:{to:{name:"filter-logs"},tag:"li"}},[e._v("\n      Filter logs\n    ")])]},proxy:!0}])})},[],!1,null,"9e35e84e",null).exports),I=Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),t("path",{attrs:{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}})])},[],!1,null,null,null).exports,S={name:"EditLogsMenuBar",components:{MenuBar:w,IconArrowBack:I,IconDelete:v,IconOpenInNew:Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),t("path",{attrs:{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z"}})])},[],!1,null,null,null).exports},props:["logs","currentLogIndex"]},A=Object(i.a)(S,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("menu-bar",{scopedSlots:e._u([{key:"left-menu",fn:function(){return[a("router-link",{attrs:{to:{name:"logs"},tag:"li"}},[a("icon-arrow-back")],1),e._v(" "),a("li",[e._v("Edit Log")])]},proxy:!0},{key:"right-menu",fn:function(){return[e.logs[e.currentLogIndex]&&e.logs[e.currentLogIndex].remoteUri?a("a",{attrs:{href:e.logs[e.currentLogIndex].remoteUri}},[a("li",[a("icon-open-in-new")],1)]):e._e(),e._v(" "),a("li",{on:{click:function(t){return e.$emit("deleteCurrentLog")}}},[a("icon-delete")],1)]},proxy:!0},{key:"more-menu",fn:function(){return[""!==e.logs[e.currentLogIndex].remoteUri?a("a",{attrs:{href:e.logs[e.currentLogIndex].remoteUri}},[a("li",[e._v("Open in browser")])]):e._e(),e._v(" "),a("li",{on:{click:function(t){return e.$emit("deleteCurrentLog")}}},[e._v("\n      Delete from device\n    ")])]},proxy:!0}])})},[],!1,null,null,null).exports,E=a("YEIV"),j=a.n(E),D=a("gDS+"),T=a.n(D),O={name:"Autocomplete",props:["objects","searchKey","searchId","label"],data:function(){return{search:"",searchResults:[],counter:0,isOpen:!1}},methods:{openResults:function(){this.isOpen=!0},doSearch:function(e){var t=[];if(""!==e)for(var a=e.toLowerCase(),n=0;n<this.objects.length;n+=1){var o=this.objects[n];o.name.toLowerCase().includes(a)&&t.length<10&&t.push(o)}this.searchResults=t,this.search=e},selectSearchResult:function(e){""!==e&&(this.$emit("results",e),this.search="",this.doSearch(this.search))},onArrowDown:function(){this.counter<this.searchResults.length-1&&(this.counter=this.counter+1)},onArrowUp:function(e){e.preventDefault(),this.counter>0&&(this.counter=this.counter-1)},onEnter:function(){var e=this.searchResults[this.counter][this.searchId];this.selectSearchResult(e)},handleClickOutside:function(e){this.$el.contains(e.target)||(this.isOpen=!1,this.arrowCounter=-1)}},mounted:function(){document.addEventListener("click",this.handleClickOutside)},destroyed:function(){document.removeEventListener("click",this.handleClickOutside)}},F=(a("Kmra"),Object(i.a)(O,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-item form-item-name form-group"},[a("label",{staticClass:"control-label",attrs:{for:"search"}},[e._v(e._s(e.label))]),e._v(" "),a("input",{staticClass:"form-control",attrs:{placeholder:"Enter text to search",type:"text"},domProps:{value:e.search},on:{focus:e.openResults,input:function(t){return e.doSearch(t.target.value)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.onArrowDown(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.onArrowUp(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onEnter(t)}]}}),e._v(" "),a("ul",{directives:[{name:"show",rawName:"v-show",value:e.isOpen&&e.search.length>0,expression:"isOpen && search.length > 0"}],staticClass:"list-group search-results"},[0===e.searchResults.length?a("li",{staticClass:"list-group-item empty"},[e._t("empty",[e._v("No Results")])],2):e._l(e.searchResults,function(t,n){return a("li",{key:"result-"+n+"-"+Math.floor(1e6*Math.random()),staticClass:"list-group-item",class:{"is-active":n===e.counter},on:{click:function(a){return e.selectSearchResult(t[e.searchId])}}},[e._v("\n      "+e._s(t[e.searchKey])+"\n    ")])})],2)])},[],!1,null,"275bfa6e",null).exports),M=Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}}),t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}})])},[],!1,null,null,null).exports,U=Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("path",{attrs:{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}}),t("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}})])},[],!1,null,null,null).exports,$=(a("mRpm"),Object(i.a)({},function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{staticClass:"spinner",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[t("g",[t("circle",{staticClass:"path",attrs:{cx:"12",cy:"12",r:"10",fill:"none","stroke-width":"3"}})])])},[],!1,null,"40d7c23d",null).exports),q={name:"Map",data:function(){return{map:{},layers:{wkt:null,geojson:null},editor:null,selectedFeatures:null,defaultStyles:{height:"100vw"}}},props:{id:String,overrideStyles:Object,deleteSelectedFeatures:{type:Boolean,default:!1},edit:{type:Object,active:Boolean,draw:Boolean,drawType:String,modify:Boolean,snap:Boolean,default:function(){return{active:!1,draw:!0,drawType:"Polygon",modify:!0,select:!0,snap:!0}}},options:{type:Object,controls:[Boolean,Array,Function],interactions:[Boolean,Array,Function],default:function(){return{controls:!0,interactions:!0}}},wkt:{title:String,wkt:String,color:String,visible:Boolean},geojson:{title:String,url:String,color:String,visible:Boolean}},mounted:function(){var e=this;this.map=window.farmOS.map.create(this.id,this.options),this.geojson.url&&(this.layers.geojson=this.map.addLayer("geojson",this.geojson)),this.geojson.url&&!this.wkt.wkt&&this.layers.geojson.getSource().on("change",function(){e.map.zoomToVectors()}),this.wkt.wkt&&(this.layers.wkt=this.map.addLayer("wkt",this.wkt),this.map.zoomToLayer(this.layers.wkt)),this.edit.active&&(this.editor=this.map.featureEditor({layer:this.layers.wkt,type:this.edit.drawType,color:"blue",draw:this.edit.draw,select:this.edit.select,snap:this.edit.snap,modify:this.edit.modify}),this.editor.wkt.on("drawend",function(t){e.$emit("update-wkt",t)}),this.editor.wkt.on("modifyend",function(t){e.$emit("update-wkt",t)}),this.editor.wkt.on("select",function(t){"GEOMETRYCOLLECTION EMPTY"===t?e.$emit("features-selected",!1):e.$emit("features-selected",!0),e.selectedFeatures=e.editor.select.getFeatures()}))},beforeDestroy:function(){window.farmOS.map.destroy(this.id),this.map=null},watch:{deleteSelectedFeatures:function(e){var t=this;e&&(this.selectedFeatures.forEach(function(e){return t.layers.wkt.getSource().removeFeature(e)}),this.selectedFeatures.clear(),this.editor.remove("select"),this.editor.select=this.editor.add("select"),this.editor.wkt.on("select",function(e){"GEOMETRYCOLLECTION EMPTY"===e?t.$emit("features-selected",!1):t.$emit("features-selected",!0),t.selectedFeatures=t.editor.select.getFeatures()}),this.$emit("update-wkt",this.editor.wkt.get()),this.$emit("delete-features"))},edit:function(e,t){var a=this;e.active&&!t.active&&(this.editor=this.map.featureEditor({layer:this.layers.wkt,type:this.edit.drawType,color:"blue",draw:this.edit.draw,snap:this.edit.snap,modify:this.edit.modify})),e.active&&t.active&&((e.draw&&!t.draw||e.drawType!==t.drawType)&&(this.editor.add("draw",e.drawType),this.editor.wkt.on("drawend",function(e){a.$emit("update-wkt",e)})),!e.draw&&t.draw&&this.editor.remove("draw"),e.modify&&!t.modify&&(this.editor.add("modify"),this.editor.wkt.on("modifyend",function(e){a.$emit("update-wkt",e)})),!e.modify&&t.modify&&this.editor.remove("modify"),e.select&&!t.select&&(this.editor.add("select"),this.editor.wkt.on("select",function(e){"GEOMETRYCOLLECTION EMPTY"===e?a.$emit("features-selected",!1):a.$emit("features-selected",!0),a.selectedFeatures=a.editor.select.getFeatures()})),!e.select&&t.select&&this.editor.remove("select"),e.snap&&!t.snap&&this.editor.add("snap"),!e.snap&&t.snap&&this.editor.remove("snap"))},wkt:function(){this.edit.active||(this.layers.wkt&&(this.map.map.removeLayer(this.layers.wkt),this.layers.wkt=null),this.wkt.wkt?(this.layers.wkt=this.map.addLayer("wkt",this.wkt),this.map.zoomToLayer(this.layers.wkt)):this.map.zoomToVectors())}}},P=Object(i.a)(q,function(){var e=this.$createElement;return(this._self._c||e)("div",{style:[this.defaultStyles,this.overrideStyles],attrs:{id:this.id}})},[],!1,null,null,null).exports,N={props:["label","labelPosition","checked"]},z=(a("5Nyv"),Object(i.a)(N,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.label&&"before"===e.labelPosition?a("label",[e._v(e._s(e.label)+" ")]):e._e(),e._v(" "),a("input",{staticClass:"toggle-check",attrs:{type:"checkbox"},domProps:{checked:e.checked},on:{input:function(t){return e.$emit("input",t.target.checked)}}}),e._v(" "),e.label&&"after"===e.labelPosition?a("label",[e._v(e._s(e.label)+" ")]):e._e()])},[],!1,null,"0f9459f7",null).exports),R={props:{id:String,selected:Boolean,label:String,small:Boolean},methods:{checkChecked:function(e){return!document.getElementById(this.id).checked}}},G=(a("rTSf"),Object(i.a)(R,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-check"},[a("input",{attrs:{type:"checkbox",id:e.id,name:e.id},domProps:{checked:e.selected}}),e._v(" "),a("label",{class:[{selected:e.selected},{small:e.small}],attrs:{for:e.id},on:{click:function(t){e.$emit("input",e.checkChecked(e.id))}}},[e._v("\n    "+e._s(e.label)+"\n  ")])])},[],!1,null,"35f02b01",null).exports),B=a("Mkpm");function H(e,t){return T()(e.coordinates)===T()(t.coordinates)}var Y={name:"EditLog",components:{Autocomplete:F,IconExpandLess:M,IconExpandMore:U,IconSpinner:$,Map:P,ToggleCheck:z,SelectBox:G},data:function(){return{tabSelected:"FIRST",imageUrls:[],attachGeo:!1,useLocalAreas:!1,addedArea:!1,isWorking:!1,showAllCategories:!1,logTypes:{farm_observation:"Observation",farm_activity:"Activity",farm_input:"Input",farm_harvest:"Harvest",farm_seeding:"Seeding"},quantMeasures:["count","length","weight","area","volume","time","temperature","water_content","value","rating","ratio","probability"]}},props:["logs","areas","assets","currentLogIndex","statusText","photoLoc","geolocation","localArea","useGeolocation","units","categories","equipment","type"],beforeMount:function(){this.$router.currentRoute.params.tab&&(this.tabSelected=this.$router.currentRoute.params.tab)},methods:{convertOutOfUnix:function(e){var t=new Date(1e3*e),a=function(e){return e<10?"0"+e:e},n=a(t.getMonth()+1),o=a(t.getDate());return t.getFullYear()+"-"+n+"-"+o},convertIntoUnix:function(e){var t=+e.split("-")[0],a=+e.split("-")[1]-1,n=+e.split("-")[2];return Math.floor(new Date(t,a,n).getTime()/1e3).toString()},forceSync:function(){this.$store.dispatch("forceSyncAssetsAndAreas")},updateCurrentLog:function(e,t){var a,n=(Date.now()/1e3).toFixed(0),o="string"==typeof t?t:T()(t),r=(a={},j()(a,e,{data:o,changed:n}),j()(a,"isCachedLocally",!1),j()(a,"wasPushedToServer",!1),a);this.$store.commit("updateCurrentLog",r)},updateNewQuant:function(e,t){var a=this.logs[this.currentLogIndex].quantity.data.length;if(0===a&&this.addQuant(),"unit"===e){var n={id:t,resource:"taxonomy_term"};this.logs[this.currentLogIndex].quantity.data[a-1][e]=n}else this.logs[this.currentLogIndex].quantity.data[a-1][e]=t;var o={quantity:this.logs[this.currentLogIndex].quantity,isCachedLocally:!1,wasPushedToServer:!1};this.$store.commit("updateCurrentLog",o)},addCategory:function(e){var t={id:e,resource:"taxonomy_term"},a=this.logs[this.currentLogIndex].log_category.data.concat(t);this.updateCurrentLog("log_category",a)},addEquipment:function(e){if(""!==e){var t={id:e,resource:"farm_asset"},a=this.logs[this.currentLogIndex].equipment.data.concat(t);this.updateCurrentLog("equipment",a)}},addAsset:function(e){var t={id:e,resource:"farm_asset"},a=this.logs[this.currentLogIndex].asset.data.concat(t);this.updateCurrentLog("asset",a)},addMovementArea:function(e){var t={id:e,resource:"farm_area"},a=function(e){var t=e.filter(function(e){return""!==e});if(0===t.length)return"";if(1===t.length)return t[0];var a=t.map(B.parse).reduce(function(e,t){if("GeometryCollection"!==t.type)return e.geometries.some(function(e){return H(e,t)})?e:{type:"GeometryCollection",geometries:e.geometries.concat(t)};var a=t.geometries.filter(function(t){return!e.geometries.some(function(e){return H(e,t)})});return{type:"GeometryCollection",geometries:e.geometries.concat(a)}},{type:"GeometryCollection",geometries:[]});return Object(B.stringify)(a)}([this.areas.find(function(t){return t.tid===e}).geofield[0].geom,this.logs[this.currentLogIndex].movement.data.geometry]),n={area:this.logs[this.currentLogIndex].movement.data.area.concat(t),geometry:a};this.updateCurrentLog("movement",n)},addArea:function(e){if(""!==e){var t={id:e,resource:"farm_area"},a=this.logs[this.currentLogIndex].area.data.concat(t);this.updateCurrentLog("area",a),this.checkAreas()}this.checkAreas()},addQuant:function(){this.logs[this.currentLogIndex].quantity.data.push({measure:"weight",value:0,unit:{id:0,resource:"taxonomy_term"},label:""})},removeAsset:function(e){var t=this.logs[this.currentLogIndex].asset.data.filter(function(t){return t.id!==e.id});this.updateCurrentLog("asset",t)},removeArea:function(e){var t=this.logs[this.currentLogIndex].area.data.filter(function(t){return t.id!==e.tid});this.updateCurrentLog("area",t)},removeMovementArea:function(e){var t=this.logs[this.currentLogIndex].movement.data.area.filter(function(t){return t.id!==e.tid}),a={geometry:function(e,t){if(""===e)return"";if(""===t)return e;var a=Object(B.parse)(e),n=Object(B.parse)(t);if("GeometryCollection"!==a.type&&"GeometryCollection"!==n.type)return H(a,n)?"":e;if("GeometryCollection"===a.type&&"GeometryCollection"!==n.type){var o={type:"GeometryCollection",geometries:a.geometries.filter(function(e){return!H(e,n)})};return o.geometries.length>0?Object(B.stringify)(o):""}if("GeometryCollection"===a.type&&"GeometryCollection"===n.type){var r={type:"GeometryCollection",geometries:a.geometries.filter(function(e){return!n.geometries.some(function(t){return H(e,t)})})};return r.geometries.length>0?Object(B.stringify)(r):""}if("GeometryCollection"!==a.type&&"GeometryCollection"===n.type)return n.geometries.some(function(e){return H(a,e)})?"":e;throw new Error("Format(s) not recognized as valid WKT.")}(this.logs[this.currentLogIndex].movement.data.geometry,e.geofield[0].geom),area:t};this.updateCurrentLog("movement",a)},removeQuant:function(e){var t=this.logs[this.currentLogIndex].quantity.data;t.splice(e,1),this.updateCurrentLog("quantity",t)},removeCategory:function(e){var t=this.logs[this.currentLogIndex].log_category.data;t.splice(e,1),this.updateCurrentLog("category",t)},removeEquipment:function(e){var t=this.logs[this.currentLogIndex].equipment.data;t.splice(e,1),this.updateCurrentLog("equipment",t)},getPhoto:function(){return this.$store.dispatch("getPhotoLoc")},loadPhoto:function(e){for(var t=0;t<e.length;t+=1)this.imageUrls.push(window.URL.createObjectURL(e[t])),this.$store.dispatch("loadPhotoBlob",e[t])},addLocation:function(){if(void 0===this.geolocation.Longitude&&(this.$store.dispatch("getGeolocation"),this.attachGeo=!0,this.isWorking=!0),void 0!==this.geolocation.Longitude){this.attachGeo=!0;var e=JSON.parse('[{"geom":"POINT ('+this.geolocation.Longitude+" "+this.geolocation.Latitude+')"}]');this.updateCurrentLog("geofield",e)}},checkAreas:function(){var e=this;this.filteredAreas.forEach(function(t){if(void 0!==t.geofield[0]&&void 0!==e.geolocation.Longitude){var a={point:[e.geolocation.Longitude,e.geolocation.Latitude],area:t,radius:.02};e.$store.dispatch("checkInNear",a)}})},getAttached:function(e,t,a){var n=[];return t.forEach(function(t){e.forEach(function(e){t[a]===e.id&&n.push(t)})}),n},assetsRequired:function(){return"farm_seeding"===this.logs[this.currentLogIndex].type.data&&this.selectedAssets<1},showGeofieldData:function(e){var t=this.logs[this.currentLogIndex];return t.geofield&&t.geofield.data.length>0&&!e.geom.includes("POLYGON")}},computed:{filteredAssets:function(){if(this.logs[this.currentLogIndex].asset){var e=this.logs[this.currentLogIndex].asset.data;return this.assets.filter(function(t){return!e.some(function(e){return t.id===e.id})})}return this.assets},filteredAreas:function(){if(this.logs[this.currentLogIndex].area){var e=this.logs[this.currentLogIndex].area.data;return this.areas.filter(function(t){return!e.some(function(e){return t.tid===e.id})})}return this.areas},filteredMovementAreas:function(){if(this.logs[this.currentLogIndex].movement.data.area){var e=this.logs[this.currentLogIndex].movement.data.area;return this.areas.filter(function(t){return!e.some(function(e){return t.tid===e.id})})}return this.areas},selectedAssets:function(){if(this.logs[this.currentLogIndex].asset)return this.getAttached(this.logs[this.currentLogIndex].asset.data,this.assets,"id")},selectedAreas:function(){if(this.logs[this.currentLogIndex].area)return this.getAttached(this.logs[this.currentLogIndex].area.data,this.areas,"tid")},selectedMovementAreas:function(){if(this.logs[this.currentLogIndex].movement.data.area)return this.getAttached(this.logs[this.currentLogIndex].movement.data.area,this.areas,"tid")},quantUnitNames:function(){var e=this;if(this.units.length>0&&this.logs[this.currentLogIndex].quantity.data.length>0){var t=[];return this.logs[this.currentLogIndex].quantity.data.forEach(function(a){a.unit&&e.units.forEach(function(e){parseInt(e.tid,10)===parseInt(a.unit.id,10)&&t.push(e.name)})}),t}return[]},categoryNames:function(){var e=this;if(this.categories.length>0&&this.logs[this.currentLogIndex].log_category.data.length>0){var t=[];return this.logs[this.currentLogIndex].log_category.data.forEach(function(a){e.categories.forEach(function(e){parseInt(e.tid,10)===parseInt(a.id,10)&&t.push(e.name)})}),t}return[]},equipmentNames:function(){var e=this;if(this.equipment.length>0&&this.logs[this.currentLogIndex].equipment&&this.logs[this.currentLogIndex].equipment.data.length>0){var t=[];return this.logs[this.currentLogIndex].equipment.data.forEach(function(a){e.equipment.forEach(function(e){parseInt(e.id,10)===parseInt(a.id,10)&&t.push(e.name)})}),t}return[]},areaGeoJSON:function(){return localStorage.getItem("host")+"/farm/areas/geojson/all"}},watch:{photoLoc:function(){this.updateCurrentLog("images",this.photoLoc)},geolocation:function(){if(this.attachGeo&&void 0!==this.geolocation.Longitude){var e=JSON.parse('[{"geom":"POINT ('+this.geolocation.Longitude+" "+this.geolocation.Latitude+')"}]');this.updateCurrentLog("geofield",e),this.isWorking=!1}this.useLocalAreas&&void 0!==this.geolocation.Longitude&&(this.checkAreas(),this.isWorking=!1)},useLocalAreas:function(){this.useLocalAreas&&(void 0===this.geolocation.Longitude&&(this.$store.commit("clearLocalArea"),this.$store.dispatch("getGeolocation"),this.isWorking=!0),void 0!==this.geolocation.Longitude&&(this.$store.commit("clearLocalArea"),this.checkAreas()))},$route:function(e){"number"==typeof e.params.index?this.$store.commit("setCurrentLogIndex",this.$route.params.index):this.$store.dispatch("initializeLog",this.type)}}},V=(a("b3WB"),Object(i.a)(Y,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tab-container"},[a("div",{staticClass:"tab-bar"},[a("div",{staticClass:"tab",class:{selected:"FIRST"===e.tabSelected},on:{click:function(t){e.tabSelected="FIRST"}}},[a("h5",[e._v("GENERAL")])]),e._v(" "),a("div",{staticClass:"tab",class:{selected:"SECOND"===e.tabSelected},on:{click:function(t){e.tabSelected="SECOND"}}},[a("h5",[e._v("MOVEMENT")])])]),e._v(" "),a("div",{staticClass:"tab-indicator",class:[{first:"FIRST"===e.tabSelected},{second:"SECOND"===e.tabSelected}]}),e._v(" "),a("div",{staticClass:"container-fluid tab-content first",class:{selected:"FIRST"===e.tabSelected}},[a("br"),e._v(" "),a("div",{staticClass:"form-item form-group"},[a("toggle-check",{attrs:{label:"Done",labelPosition:"after",checked:e.logs[e.currentLogIndex].done.data},on:{input:function(t){return e.updateCurrentLog("done",t)}}})],1),e._v(" "),a("div",{staticClass:"form-item form-item-name form-group"},[a("label",{staticClass:"control-label",attrs:{for:"name"}},[e._v("Name")]),e._v(" "),a("input",{staticClass:"form-control",attrs:{placeholder:"Enter name",type:"text",autofocus:""},domProps:{value:e.logs[e.currentLogIndex].name.data},on:{input:function(t){return e.updateCurrentLog("name",t.target.value)}}})]),e._v(" "),a("div",{staticClass:"form-item form-item-name form-group"},[a("label",{staticClass:"control-label",attrs:{for:"Date"}},[e._v("Date")]),e._v(" "),a("input",{staticClass:"form-control",attrs:{type:"date"},domProps:{value:e.convertOutOfUnix(e.logs[e.currentLogIndex].timestamp.data)},on:{input:function(t){e.updateCurrentLog("timestamp",e.convertIntoUnix(t.target.value))}}})]),e._v(" "),a("div",{staticClass:"form-item form-item-name form-group"},[a("label",{staticClass:"control-label ",attrs:{for:"type"}},[e._v("Log Type")]),e._v(" "),a("div",{staticClass:"input-group"},[a("select",{staticClass:"custom-select col-sm-3 ",domProps:{value:e.logs[e.currentLogIndex].type.data},on:{input:function(t){return e.updateCurrentLog("type",t.target.value)}}},e._l(e.logTypes,function(t,n){return a("option",{key:t+"-"+n,domProps:{value:n}},[e._v("\n              "+e._s(t)+"\n            ")])}),0)])]),e._v(" "),a("div",{staticClass:"form-item form-item-name form-group"},[a("label",{staticClass:"control-label ",attrs:{for:"notes"}},[e._v("Notes")]),e._v(" "),a("textarea",{staticClass:"form-control",attrs:{placeholder:"Enter notes",type:"text"},domProps:{value:e.logs[e.currentLogIndex].notes.data},on:{input:function(t){return e.updateCurrentLog("notes",t.target.value)}}})]),e._v(" "),a("h4",[e._v("Log Categories")]),e._v(" "),a("div",{staticClass:"form-item form-group",attrs:{id:"categories"}},[!e.showAllCategories&&e.logs[e.currentLogIndex].log_category.data.length<1?a("p",[e._v("No categories selected")]):e._e(),e._v(" "),e._l(e.categories,function(t){return e.showAllCategories||e.logs[e.currentLogIndex].log_category.data.some(function(e){return t.tid===e.id})?a("select-box",{key:"category-"+t.tid+"-"+t.name,attrs:{small:"",id:"category-"+t.tid+"-"+t.name,selected:e.logs[e.currentLogIndex].log_category.data.some(function(e){return t.tid===e.id}),label:t.name},on:{input:function(a){a?e.addCategory(t.tid):e.removeCategory(e.logs[e.currentLogIndex].log_category.data.findIndex(function(e){return t.tid===e.id}))}}}):e._e()}),e._v(" "),a("div",{staticClass:"show-hide"},[e.showAllCategories?e._e():a("div",{on:{click:function(t){e.showAllCategories=!e.showAllCategories}}},[a("p",[a("icon-expand-more"),e._v("Show More")],1)]),e._v(" "),e.showAllCategories?a("div",{on:{click:function(t){e.showAllCategories=!e.showAllCategories}}},[a("p",[a("icon-expand-less"),e._v("Show Less")],1)]):e._e()])],2),e._v(" "),a("h4",[e._v("Quantities")]),e._v(" "),a("label",{staticClass:"control-label ",attrs:{for:"quantity"}},[e._v("Add new or edit existing quantity")]),e._v(" "),a("div",{staticClass:"form-item form-item-name form-group"},[a("select",{staticClass:"custom-select col-sm-3 ",attrs:{placeholder:"Quantity measure"},domProps:{value:e.logs[e.currentLogIndex].quantity.data.length>0?e.logs[e.currentLogIndex].quantity.data[e.logs[e.currentLogIndex].quantity.data.length-1].measure:""},on:{input:function(t){return e.updateNewQuant("measure",t.target.value)}}},e._l(e.quantMeasures,function(t){return a("option",{domProps:{value:t}},[e._v("\n            "+e._s(t)+"\n          ")])}),0),e._v(" "),a("input",{staticClass:"form-control",attrs:{placeholder:"Quantity value",type:"number"},domProps:{value:e.logs[e.currentLogIndex].quantity.data.length>0?e.logs[e.currentLogIndex].quantity.data[e.logs[e.currentLogIndex].quantity.data.length-1].value:0},on:{input:function(t){return e.updateNewQuant("value",t.target.value)}}}),e._v(" "),a("select",{staticClass:"custom-select col-sm-3 ",attrs:{placeholder:"Quantity unit"},on:{input:function(t){return e.updateNewQuant("unit",t.target.value)}}},e._l(e.units,function(t){return a("option",{domProps:{value:t.tid}},[e._v("\n            "+e._s(e.units?t.name:"")+"\n          ")])}),0),e._v(" "),a("input",{staticClass:"form-control",attrs:{placeholder:"Quantity label",type:"text"},domProps:{value:e.logs[e.currentLogIndex].quantity.data.length>0?e.logs[e.currentLogIndex].quantity.data[e.logs[e.currentLogIndex].quantity.data.length-1].label:""},on:{input:function(t){return e.updateNewQuant("label",t.target.value)}}})]),e._v(" "),a("div",{staticClass:"form-item form-group"},[e.logs[e.currentLogIndex].quantity.data.length>0?a("ul",{staticClass:"list-group"},e._l(e.logs[e.currentLogIndex].quantity.data,function(t,n){return a("li",{key:"quantity-"+n+"-"+Math.floor(1e6*Math.random()),staticClass:"list-group-item"},[e._v("\n          "+e._s(t.value)+" "+e._s(e.quantUnitNames.length>0?e.quantUnitNames[n]:"")+" "+e._s(t.label)+"\n          "),a("span",{staticClass:"remove-list-item",on:{click:function(t){return e.removeQuant(n)}}},[e._v("\n            ✕\n          ")])])}),0):e._e()]),e._v(" "),a("div",{staticClass:"form-item form-group"},[a("button",{staticClass:"btn btn-success",attrs:{type:"button",name:"addNewQuantity"},on:{click:e.addQuant}},[e._v("\n        Add another quantity\n      ")])]),e._v(" "),a("h4",[e._v("Assets")]),e._v(" "),a("Autocomplete",{class:{invalid:e.assetsRequired()},attrs:{objects:e.filteredAssets,searchKey:"name",searchId:"id",label:e.assetsRequired()?"Seedings must include assets!":"Add assets to the log"},on:{results:function(t){return e.addAsset(t)}}},[a("template",{slot:"empty"},[a("div",{staticClass:"empty-slot"},[a("em",[e._v("No assets found.")]),e._v(" "),a("br"),e._v(" "),a("button",{staticClass:"btn btn-light",attrs:{type:"button",name:"button"},on:{click:e.forceSync}},[e._v("\n            Sync Now\n          ")])])])],2),e._v(" "),a("div",{staticClass:"form-item form-item-name form-group"},[a("ul",{staticClass:"list-group"},e._l(e.selectedAssets,function(t,n){return a("li",{key:"log-"+n+"-"+Math.floor(1e6*Math.random()),staticClass:"list-group-item"},[e._v("\n          "+e._s(t.name)+"\n          "),a("span",{staticClass:"remove-list-item",on:{click:function(a){return e.removeAsset(t)}}},[e._v("\n            ✕\n          ")])])}),0)]),e._v(" "),a("div",{staticClass:"form-item form-item-name form-group"},[a("label",{staticClass:"control-label ",attrs:{for:"type"}},[e._v("Equipment")]),e._v(" "),a("div",{staticClass:"input-group"},[a("select",{staticClass:"custom-select col-sm-3 ",on:{input:function(t){return e.addEquipment(t.target.value)}}},[a("option",{attrs:{value:""}}),e._v(" "),e._l(e.equipment,function(t){return a("option",{domProps:{value:t.id}},[e._v("\n            "+e._s(t?t.name:"")+"\n          ")])})],2)])]),e._v(" "),a("div",{staticClass:"form-item form-group"},[e.logs[e.currentLogIndex].equipment?a("ul",{staticClass:"list-group"},e._l(e.logs[e.currentLogIndex].equipment.data,function(t,n){return a("li",{key:"log-"+n+"-"+Math.floor(1e6*Math.random()),staticClass:"list-group-item"},[e._v("\n          "+e._s(e.equipmentNames.length>0?e.equipmentNames[n]:"")+"\n          "),a("span",{staticClass:"remove-list-item",on:{click:function(t){return e.removeEquipment(n)}}},[e._v("\n            ✕\n          ")])])}),0):e._e()]),e._v(" "),"farm_seeding"!==e.logs[e.currentLogIndex].type.data?a("div",{attrs:{id:"areas-and-location"}},[a("h4",[e._v("Areas & Location")]),e._v(" "),e.useGeolocation?a("div",{staticClass:"form-item form-item-name form-group"},[a("div",{staticClass:"form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.useLocalAreas,expression:"useLocalAreas"}],staticClass:"form-check-input",attrs:{type:"radio",id:"dontUseGeo",name:"geoRadioGroup",checked:""},domProps:{value:!1,checked:e._q(e.useLocalAreas,!1)},on:{change:function(t){e.useLocalAreas=!1}}}),e._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"dontUseGeo"}},[e._v("Search areas")])]),e._v(" "),a("div",{staticClass:"form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.useLocalAreas,expression:"useLocalAreas"}],staticClass:"form-check-input",attrs:{type:"radio",id:"doUseGeo",name:"geoRadioGroup"},domProps:{value:!0,checked:e._q(e.useLocalAreas,!0)},on:{change:function(t){e.useLocalAreas=!0}}}),e._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"doUseGeo"}},[e._v("Use my location")])])]):e._e(),e._v(" "),e.useLocalAreas?a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"areaSelector"}},[e._v("Farm areas near your current location")]),e._v(" "),a("select",{staticClass:"form-control",attrs:{name:"areas"},on:{input:function(t){return e.addArea(t.target.value)}}},[e.localArea.length<1?a("option",{attrs:{value:""}},[e._v("No other areas nearby")]):e._e(),e._v(" "),e.localArea.length>0?a("option",{attrs:{value:"",selected:""}},[e._v("-- Select an Area --")]):e._e(),e._v(" "),e._l(e.localArea,function(t){return e.localArea.length>0?a("option",{key:"area-"+t.tid,domProps:{value:t.tid}},[e._v("\n            "+e._s(t.name)+"\n          ")]):e._e()})],2)]):e._e(),e._v(" "),e.useLocalAreas?e._e():a("Autocomplete",{attrs:{objects:e.filteredAreas,searchKey:"name",searchId:"tid",label:"Add areas to the log"},on:{results:function(t){return e.addArea(t)}}},[a("template",{slot:"empty"},[a("div",{staticClass:"empty-slot"},[a("em",[e._v("No areas found.")]),e._v(" "),a("br"),e._v(" "),a("button",{staticClass:"btn btn-light",attrs:{type:"button",name:"button"},on:{click:e.forceSync}},[e._v("\n              Sync Now\n            ")])])])],2),e._v(" "),a("div",{staticClass:"form-item form-item-name form-group"},[a("ul",{staticClass:"list-group"},e._l(e.selectedAreas,function(t,n){return a("li",{key:"log-"+n+"-"+Math.floor(1e6*Math.random()),staticClass:"list-group-item"},[e._v("\n            "+e._s(t.name)+"\n            "),a("span",{staticClass:"remove-list-item",on:{click:function(a){return e.removeArea(t)}}},[e._v("\n              ✕\n            ")])])}),0)]),e._v(" "),e.useGeolocation?a("div",{staticClass:"form-item form-item-name form-group"},[a("button",{staticClass:"btn btn-success btn-navbar",attrs:{disabled:!1,title:"Add my GPS location to the log",type:"button"},on:{click:e.addLocation}},[e._v("\n          Add my GPS location to the log\n        ")])]):e._e(),e._v(" "),a("div",{staticClass:"form-item form-item-name form-group"},[a("ul",{staticClass:"list-group"},[e._l(e.logs[e.currentLogIndex].geofield.data,function(t){return e.showGeofieldData(t)?a("li",{staticClass:"list-group-item"},[e._v("\n            "+e._s(t.geom)+"\n            "),a("span",{staticClass:"remove-list-item",on:{click:function(t){return e.updateCurrentLog("geofield",[])}}},[e._v("\n              ✕\n            ")])]):e._e()}),e._v(" "),e.attachGeo&&e.isWorking?a("li",{staticClass:"list-item-group"},[a("icon-spinner")],1):e._e()],2)])],1):e._e(),e._v(" "),a("h4",[e._v("Images")]),e._v(" "),a("div",{staticClass:"form-item form-item-name form-group"},[a("button",{staticClass:"btn btn-info btn-navbar navbar-right",attrs:{disabled:!1,title:"Take picture with camera",type:"button"},on:{click:e.getPhoto}},[e._v("\n        Take picture with camera\n      ")])]),e._v(" "),a("div",{staticClass:"form-item form-item-name form-group"},[a("div",{staticClass:"input-group "},[a("label",{staticClass:"custom-file-label",attrs:{for:"customFile"}},[e._v("\n          Select photo from file\n        ")]),e._v(" "),a("input",{ref:"photo",staticClass:"custom-file-input",attrs:{type:"file"},on:{change:function(t){return e.loadPhoto(t.target.files)}}})])]),e._v(" "),a("div",{staticClass:"form-item form-item-name form-group"},e._l(e.imageUrls,function(t){return a("img",{key:"preview-"+e.imageUrls.indexOf(t),staticClass:"preview",attrs:{src:t}})}),0)],1),e._v(" "),a("div",{staticClass:"container-fluid tab-content second",class:{selected:"SECOND"===e.tabSelected}},[a("br"),e._v(" "),a("Autocomplete",{class:{invalid:e.assetsRequired()},attrs:{objects:e.filteredAssets,searchKey:"name",searchId:"id",label:e.assetsRequired()?"Seedings must include assets!":"Add assets to be moved"},on:{results:function(t){return e.addAsset(t)}}},[a("template",{slot:"empty"},[a("div",{staticClass:"empty-slot"},[a("em",[e._v("No assets found.")]),e._v(" "),a("br"),e._v(" "),a("button",{staticClass:"btn btn-light",attrs:{type:"button",name:"button"},on:{click:e.forceSync}},[e._v("\n            Sync Now\n          ")])])])],2),e._v(" "),a("div",{staticClass:"form-item form-item-name form-group"},[a("ul",{staticClass:"list-group"},e._l(e.selectedAssets,function(t,n){return a("li",{key:"asset-"+n+"-"+Math.floor(1e6*Math.random()),staticClass:"list-group-item"},[e._v("\n          "+e._s(t.name)+"\n          "),a("span",{staticClass:"remove-list-item",on:{click:function(a){return e.removeAsset(t)}}},[e._v("\n            ✕\n          ")])])}),0)]),e._v(" "),a("Autocomplete",{attrs:{objects:e.filteredMovementAreas,searchKey:"name",searchId:"tid",label:"Movement to"},on:{results:function(t){return e.addMovementArea(t)}}},[a("template",{slot:"empty"},[a("div",{staticClass:"empty-slot"},[a("em",[e._v("No areas found.")]),e._v(" "),a("br"),e._v(" "),a("button",{staticClass:"btn btn-light",attrs:{type:"button",name:"button"},on:{click:e.forceSync}},[e._v("\n            Sync Now\n          ")])])])],2),e._v(" "),a("div",{staticClass:"form-item form-item-name form-group"},[a("ul",{staticClass:"list-group"},e._l(e.selectedMovementAreas,function(t,n){return a("li",{key:"log-"+n+"-"+Math.floor(1e6*Math.random()),staticClass:"list-group-item"},[e._v("\n          "+e._s(t.name)+"\n          "),a("span",{staticClass:"remove-list-item",on:{click:function(a){return e.removeMovementArea(t)}}},[e._v("\n            ✕\n          ")])])}),0)]),e._v(" "),a("router-link",{attrs:{to:{name:"edit-map"}}},[a("Map",{attrs:{id:"map",overrideStyles:{height:"90vw"},options:{controls:function(e){return e.filter(function(e){return"Attribution"===e.constructor.name})},interactions:!1},wkt:{title:"movement",wkt:e.logs[e.currentLogIndex].movement.data.geometry,color:"orange"},geojson:{title:"areas",url:e.areaGeoJSON,color:"grey"}}})],1)],1)])},[],!1,null,"6a269a54",null).exports),Q={name:"EditMapMenuBar",components:{MenuBar:w,IconArrowBack:I,IconDelete:v},props:["logs","currentLogIndex","mapFeatureSelected"],computed:{logLink:function(){return{name:"edit-log",params:{index:this.currentLogIndex,type:this.logs[this.currentLogIndex].type.data,tab:"SECOND"}}}}},J=Object(i.a)(Q,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("menu-bar",{attrs:{more:!1},scopedSlots:e._u([{key:"left-menu",fn:function(){return[a("router-link",{attrs:{to:e.logLink,tag:"li"}},[a("icon-arrow-back")],1),e._v(" "),a("li",[e._v("Map")])]},proxy:!0},{key:"right-menu",fn:function(){return[e.mapFeatureSelected?a("li",{on:{click:function(t){return e.$emit("deleteSelectedMapFeature")}}},[a("icon-delete")],1):e._e()]},proxy:!0}])})},[],!1,null,null,null).exports,W={name:"EditMap",components:{Map:P},props:["logs","currentLogIndex","deleteSelectedMapFeature"],computed:{areaGeoJSON:function(){return localStorage.getItem("host")+"/farm/areas/geojson/all"}},methods:{updateMovement:function(e){var t={movement:{data:{area:this.logs[this.currentLogIndex].movement.data.area,geometry:e},changed:(Date.now()/1e3).toFixed(0)},isCachedLocally:!1,wasPushedToServer:!1};this.$store.commit("updateCurrentLog",t)}}},K=Object(i.a)(W,function(){var e=this,t=e.$createElement;return(e._self._c||t)("Map",{attrs:{id:"map",overrideStyles:{height:"calc(100vh - 3rem)"},deleteSelectedFeatures:e.deleteSelectedMapFeature,edit:{active:!0,draw:!0,drawType:"Polygon",modify:!0,select:!0,snap:!0},wkt:{title:"movement",wkt:e.logs[e.currentLogIndex].movement.data.geometry,color:"orange"},geojson:{title:"areas",url:e.areaGeoJSON,color:"grey"}},on:{"update-wkt":e.updateMovement,"features-selected":function(t){return e.$emit("mapFeatureSelected",t)},"delete-features":function(t){return e.$emit("delete-features")}}})},[],!1,null,"6a222170",null).exports,X={name:"AllLogsMenuBar",components:{MenuBar:w,IconArrowBack:I},data:function(){return{showMore:!1}},methods:{resetDisplayFilters:function(){this.$store.dispatch("resetDisplayFilters")}}},Z=Object(i.a)(X,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("menu-bar",{scopedSlots:e._u([{key:"left-menu",fn:function(){return[a("router-link",{attrs:{to:{name:"logs"},tag:"li"}},[a("icon-arrow-back")],1),e._v(" "),a("li",[e._v("Log Filters")])]},proxy:!0},{key:"more-menu",fn:function(){return[a("li",{on:{click:e.resetDisplayFilters}},[e._v("Reset filters")])]},proxy:!0}])})},[],!1,null,null,null).exports,ee={name:"FilterLogs",props:["categories","logDisplayFilters"],methods:{updateExcludeLogType:function(e,t){t?this.$store.commit("removeFromExcludeTypes",e):this.$store.commit("addToExcludeTypes",e)},updateExcludeLogCategory:function(e,t){t?this.$store.commit("removeFromExcludeCategories",e):this.$store.commit("addToExcludeCategories",e)},setDateFilter:function(e){this.$store.commit("setDateFilter",e)},checkChecked:function(e){return!document.getElementById(e).checked}}},te=(a("OmPH"),Object(i.a)(ee,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container-fluid"},[a("br"),e._v(" "),a("h4",[e._v("Date")]),e._v(" "),a("div",{staticClass:"form-item form-group"},[a("div",{staticClass:"form-check"},[a("input",{attrs:{type:"radio",name:"date"},domProps:{value:"TODAY",checked:"TODAY"===e.logDisplayFilters.date},on:{input:function(t){return e.setDateFilter(t.target.value)}}}),e._v(" "),a("label",{class:{selected:"TODAY"===e.logDisplayFilters.date},attrs:{for:"date"},on:{click:function(t){return e.setDateFilter("TODAY")}}},[e._v("\n        Today\n      ")])]),e._v(" "),a("div",{staticClass:"form-check"},[a("input",{attrs:{type:"radio",name:"date"},domProps:{value:"THIS_WEEK",checked:"THIS_WEEK"===e.logDisplayFilters.date},on:{input:function(t){return e.setDateFilter(t.target.value)}}}),e._v(" "),a("label",{class:{selected:"THIS_WEEK"===e.logDisplayFilters.date},attrs:{for:"date"},on:{click:function(t){return e.setDateFilter("THIS_WEEK")}}},[e._v("\n        This Week\n      ")])]),e._v(" "),a("div",{staticClass:"form-check"},[a("input",{attrs:{type:"radio",name:"date"},domProps:{value:"THIS_MONTH",checked:"THIS_MONTH"===e.logDisplayFilters.date},on:{input:function(t){return e.setDateFilter(t.target.value)}}}),e._v(" "),a("label",{class:{selected:"THIS_MONTH"===e.logDisplayFilters.date},attrs:{for:"date"},on:{click:function(t){return e.setDateFilter("THIS_MONTH")}}},[e._v("\n        This Month\n      ")])]),e._v(" "),a("div",{staticClass:"form-check"},[a("input",{attrs:{type:"radio",name:"date"},domProps:{value:"THIS_YEAR",checked:"THIS_YEAR"===e.logDisplayFilters.date},on:{input:function(t){return e.setDateFilter(t.target.value)}}}),e._v(" "),a("label",{class:{selected:"THIS_YEAR"===e.logDisplayFilters.date},attrs:{for:"date"},on:{click:function(t){return e.setDateFilter("THIS_YEAR")}}},[e._v("\n        This Year\n      ")])]),e._v(" "),a("div",{staticClass:"form-check"},[a("input",{attrs:{type:"radio",name:"date"},domProps:{value:"ALL_TIME",checked:"ALL_TIME"===e.logDisplayFilters.date},on:{input:function(t){return e.setDateFilter(t.target.value)}}}),e._v(" "),a("label",{class:{selected:"ALL_TIME"===e.logDisplayFilters.date},attrs:{for:"date"},on:{click:function(t){return e.setDateFilter("ALL_TIME")}}},[e._v("\n        All Time\n      ")])])]),e._v(" "),a("h4",[e._v("Log Type")]),e._v(" "),a("div",{staticClass:"form-item form-group"},[a("div",{staticClass:"form-check"},[a("input",{attrs:{type:"checkbox",id:"type-farm-activity",name:"log-types"},domProps:{checked:!e.logDisplayFilters.excludeTypes.includes("farm_activity")},on:{input:function(t){return e.updateExcludeLogType("farm_activity",t.target.checked)}}}),e._v(" "),a("label",{class:{selected:!e.logDisplayFilters.excludeTypes.includes("farm_activity")},attrs:{for:"log-types"},on:{click:function(t){e.updateExcludeLogType("farm_activity",e.checkChecked("type-farm-activity"))}}},[e._v("\n        Activity\n      ")])]),e._v(" "),a("div",{staticClass:"form-check"},[a("input",{attrs:{type:"checkbox",id:"type-farm-harvest",name:"log-types"},domProps:{checked:!e.logDisplayFilters.excludeTypes.includes("farm_harvest")},on:{input:function(t){return e.updateExcludeLogType("farm_harvest",t.target.checked)}}}),e._v(" "),a("label",{class:{selected:!e.logDisplayFilters.excludeTypes.includes("farm_harvest")},attrs:{for:"log-types"},on:{click:function(t){e.updateExcludeLogType("farm_harvest",e.checkChecked("type-farm-harvest"))}}},[e._v("\n        Harvest\n      ")])]),e._v(" "),a("div",{staticClass:"form-check"},[a("input",{attrs:{type:"checkbox",id:"type-farm-input",name:"log-types"},domProps:{checked:!e.logDisplayFilters.excludeTypes.includes("farm_input")},on:{input:function(t){return e.updateExcludeLogType("farm_input",t.target.checked)}}}),e._v(" "),a("label",{class:{selected:!e.logDisplayFilters.excludeTypes.includes("farm_input")},attrs:{for:"log-types"},on:{click:function(t){e.updateExcludeLogType("farm_input",e.checkChecked("type-farm-input"))}}},[e._v("\n        Input\n      ")])]),e._v(" "),a("div",{staticClass:"form-check"},[a("input",{attrs:{type:"checkbox",id:"type-farm-observation",name:"log-types"},domProps:{checked:!e.logDisplayFilters.excludeTypes.includes("farm_observation")},on:{input:function(t){return e.updateExcludeLogType("farm_observation",t.target.checked)}}}),e._v(" "),a("label",{class:{selected:!e.logDisplayFilters.excludeTypes.includes("farm_observation")},attrs:{for:"log-types"},on:{click:function(t){e.updateExcludeLogType("farm_observation",e.checkChecked("type-farm-observation"))}}},[e._v("\n        Observation\n      ")])]),e._v(" "),a("div",{staticClass:"form-check"},[a("input",{attrs:{type:"checkbox",id:"type-farm-seeding",name:"log-types"},domProps:{checked:!e.logDisplayFilters.excludeTypes.includes("farm_seeding")},on:{input:function(t){return e.updateExcludeLogType("farm_seeding",t.target.checked)}}}),e._v(" "),a("label",{class:{selected:!e.logDisplayFilters.excludeTypes.includes("farm_seeding")},attrs:{for:"log-types"},on:{click:function(t){e.updateExcludeLogType("farm_seeding",e.checkChecked("type-farm-seeding"))}}},[e._v("\n        Seeding\n      ")])])]),e._v(" "),a("h4",[e._v("Log Category")]),e._v(" "),a("div",{staticClass:"form-item form-group"},[a("div",{staticClass:"form-check"},[a("input",{attrs:{type:"checkbox",id:"category-none",name:"log-categories"},domProps:{checked:!e.logDisplayFilters.excludeCategories.includes(-1)},on:{input:function(t){return e.updateExcludeLogCategory(-1,t.target.checked)}}}),e._v(" "),a("label",{class:{selected:!e.logDisplayFilters.excludeCategories.includes(-1)},attrs:{for:"log-categories"},on:{click:function(t){e.updateExcludeLogCategory(-1,e.checkChecked("category-none"))}}},[e._v("\n        No Category\n      ")])]),e._v(" "),e._l(e.categories,function(t){return a("div",{staticClass:"form-check"},[a("input",{attrs:{type:"checkbox",id:"category-"+t.tid,name:"log-categories"},domProps:{checked:!e.logDisplayFilters.excludeCategories.includes(t.tid)},on:{input:function(a){return e.updateExcludeLogCategory(t.tid,a.target.checked)}}}),e._v(" "),a("label",{class:{selected:!e.logDisplayFilters.excludeCategories.includes(t.tid)},attrs:{for:"log-categories"},on:{click:function(a){e.updateExcludeLogCategory(t.tid,e.checkChecked("category-"+t.tid))}}},[e._v("\n        "+e._s(t.name)+"\n      ")])])})],2)])},[],!1,null,"b60fe192",null).exports);n.a.use(o.a);var ae=new o.a({routes:[{path:"/",redirect:"/logs"},{path:"/logs",component:c,children:[{path:"",name:"logs",components:{default:_,menubar:k}},{path:"edit/:type",name:"edit-log",components:{default:V,menubar:A},props:{default:!0,menubar:!0},children:[]},{path:"map",name:"edit-map",components:{default:K,menubar:J},props:{default:!0,menubar:!0}},{path:"filter",name:"filter-logs",components:{default:te,menubar:Z}}]}]}),ne=a("QbLZ"),oe=a.n(ne),re=a("GQeE"),se=a.n(re),ie=a("EJiy"),ce=a.n(ie),le="FARMOS_SERVER",ue="VUEX_STORE",de=(Date.now()/1e3).toFixed(0);function me(e){if("object"===(void 0===e?"undefined":ce()(e))){var t=[];return Array.isArray(e)?e.forEach(function(e){"string"==typeof e?t.push(e):se()(e).forEach(function(a){e[a].id?t.push(""+e[a].id):t.push(e[a])})}):se()(e).forEach(function(a){t.push(e[a])}),t}if("string"==typeof e)return""===e?[]:[].concat(e);throw new Error(e+" cannot be parsed as an image array")}function he(e){if("object"===(void 0===e?"undefined":ce()(e)))return e;if("string"==typeof e)return JSON.parse(e);throw new Error(e+" cannot be parsed as an object array")}function ge(e){return Array.isArray(e)?e.map(function(e){return"d"===e.charAt(0)?e:{fid:e}}):e}function pe(e){return void 0!==e.value&&""!==e.value&&null!==e.value?e.value.slice(3,-5):""}var fe=function(e,t){if(e===ue||void 0===e)return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=e.log_owner,n=void 0===a?{changed:null,data:""}:a,o=e.quantity,r=void 0===o?{changed:null,data:[]}:o,s=e.log_category,i=void 0===s?{changed:null,data:[]}:s,c=e.equipment,l=void 0===c?{changed:null,data:[]}:c,u=e.id,d=e.local_id,m=e.name,h=void 0===m?{changed:null,data:""}:m,g=e.type,p=void 0===g?{changed:null,data:""}:g,f=e.timestamp,v=void 0===f?{changed:null,data:""}:f,y=e.images,_=void 0===y?{changed:null,data:[]}:y,C=e.done,w=void 0===C?{changed:null,data:!0}:C,b=e.isCachedLocally,L=void 0!==b&&b,x=e.isReadyToSync,k=void 0!==x&&x,I=e.wasPushedToServer,S=void 0!==I&&I,A=e.remoteUri,E=void 0===A?"":A,j=e.asset,D=void 0===j?{changed:null,data:[]}:j,T=e.area,O=void 0===T?{changed:null,data:[]}:T,F=e.geofield,M=void 0===F?{changed:null,data:[]}:F,U=e.notes,$=void 0===U?{changed:null,data:""}:U,q=e.movement,P=void 0===q?{changed:null,data:{area:[],geometry:""}}:q,N=void 0;return t!==ue&&void 0!==t||(N={log_owner:n,notes:$,quantity:{data:he(r.data),changed:r.changed},log_category:{data:he(i.data),changed:i.changed},equipment:{data:he(l.data),changed:l.changed},id:u,local_id:d,name:h,type:p,timestamp:v,images:{data:me(_.data),changed:_.changed},done:{data:JSON.parse(w.data),changed:w.changed},isCachedLocally:JSON.parse(L),isReadyToSync:JSON.parse(k),wasPushedToServer:JSON.parse(S),remoteUri:E,asset:{data:he(D.data),changed:D.changed},movement:{data:he(P.data),changed:P.changed}},"farm_seeding"!==p.data&&O&&(N.area={data:he(O.data),changed:O.changed}),"farm_seeding"!==p.data&&M&&(N.geofield={data:he(M.data),changed:M.changed})),t===le&&(N={notes:{format:"farm_format",value:$.data},name:h.data,done:w.data?1:0,type:p.data,timestamp:v.data,images:ge(_.data),asset:D.data,quantity:r.data,log_category:i.data,equipment:l.data,movement:P.data},u&&(N.id=u),"farm_seeding"!==p.data&&O&&(N.area=O.data),"farm_seeding"!==p.data&&M&&(N.geofield=M.data)),"INDEXEDDB"===t&&(N={log_owner:n,notes:$,quantity:r,log_category:i,equipment:l,id:u,name:h,type:p,timestamp:v,images:_,done:w,wasPushedToServer:S,remoteUri:E,asset:D,movement:P},d&&(N.local_id=d),"farm_seeding"!==p.data&&O&&(N.area=O),"farm_seeding"!==p.data&&M&&(N.geofield=M)),N};if(e===le)return function(e){var t=e.log_owner,a=e.quantity,n=e.log_category,o=e.equipment,r=e.id,s=e.local_id,i=e.name,c=e.type,l=e.timestamp,u=e.images,d=e.done,m=e.url,h=e.asset,g=e.area,p=e.geofield,f=e.notes,v=e.movement,y={log_owner:{data:t,changed:de},notes:{data:pe(f),changed:de},quantity:{data:a,changed:de},log_category:{data:n,changed:de},equipment:{data:o,changed:de},local_id:s,name:{data:i,changed:de},type:{data:c,changed:de},timestamp:{data:l,changed:de},images:{data:u,changed:de},done:{data:d,changed:de},isCachedLocally:!1,wasPushedToServer:!0,remoteUri:m,asset:{data:h,changed:de},movement:{data:v,changed:de}};return"farm_seeding"!==c&&g&&(y.area={data:g,changed:de}),"farm_seeding"!==c&&p&&(y.geofield={data:p,changed:de}),r&&(y.id=r),y};throw new Error("Incorrect parameters passed to makeLog")},ve={create:fe(),toStore:fe(ue,ue),toIdb:fe(ue,"INDEXEDDB"),toServer:fe(ue,le),fromServer:fe(le,ue)},ye=a("WVt+"),_e={actions:{getGeolocation:function(e){var t=e.commit,a={};navigator.geolocation.getCurrentPosition(function(e){a.Latitude=e.coords.latitude,a.Longitude=e.coords.longitude,a.Altitude=e.coords.altitude,a.Accuracy=e.coords.accuracy,a.AltitudeAccuracy=e.coords.altitudeAccuracy,a.Heading=e.coords.heading,a.Speed=e.coords.speed,a.Timestamp=e.timestamp,t("setGeoloc",a)},function(e){})},checkInNear:function(e,t){var a=e.commit;function n(e){var t=e.split(", "),a=[];return t.forEach(function(e){var t=e.split(" ");a.push([Number(t[0]),Number(t[1])])}),a}var o=function(e){var t=[];return e.includes("GEOMETRY")?e.slice(30,-3).split(")), POLYGON ((").forEach(function(e){t.push(n(e))}):t.push(n(e.slice(10,-2))),t}(t.area.geofield[0].geom),r=ye.circle(t.point,t.radius,{units:"kilometers"}),s=ye.polygon(o),i=ye.inside(t.point,s),c=null!==ye.intersect(r,s);(i||c)&&a("addLocalArea",t.area)}}};n.a.use(r.a);var Ce={state:{errors:[],user:{name:"",email:"",uid:null,isLoggedIn:!1},settings:{useGeolocation:!0,logImportFilters:{log_owner:null,done:"0",type:["farm_activity","farm_observation","farm_harvest","farm_input","farm_seeding"]},logDisplayFilters:{date:"ALL_TIME",excludeTypes:[],excludeCategories:[]}}},mutations:{logError:function(e,t){e.errors=e.errors.concat([t])},dismissError:function(e,t){var a=oe()({},e.errors[t],{show:!1});e.errors.splice(t,1,a)},changeUsername:function(e,t){e.user.name=t},changeEmail:function(e,t){e.user.email=t},changeUid:function(e,t){e.user.uid=t,e.settings.logImportFilters.log_owner=t},setLoginStatus:function(e,t){e.user.isLoggedIn=t},setUseGeolocation:function(e,t){e.settings.useGeolocation=t},addToExcludeTypes:function(e,t){var a=e.settings.logDisplayFilters.excludeTypes.concat(t);e.settings.logDisplayFilters.excludeTypes=a,localStorage.setItem("excludeTypes",T()(a))},removeFromExcludeTypes:function(e,t){var a=e.settings.logDisplayFilters.excludeTypes.filter(function(e){return t!==e});e.settings.logDisplayFilters.excludeTypes=a,localStorage.setItem("excludeTypes",T()(a))},addToExcludeCategories:function(e,t){var a=e.settings.logDisplayFilters.excludeCategories.concat(t);e.settings.logDisplayFilters.excludeCategories=a,localStorage.setItem("excludeCategories",T()(a))},removeFromExcludeCategories:function(e,t){var a=e.settings.logDisplayFilters.excludeCategories.filter(function(e){return t!==e});e.settings.logDisplayFilters.excludeCategories=a,localStorage.setItem("excludeCategories",T()(a))},setDateFilter:function(e,t){e.settings.logDisplayFilters.date=t,localStorage.setItem("dateFilter",t)},clearDisplayFilters:function(e){e.settings.logDisplayFilters={date:"ALL_TIME",excludeTypes:[],excludeCategories:[]}}},actions:{loadCachedDisplayFilters:function(e){var t=e.commit,a=JSON.parse(localStorage.getItem("excludeTypes")),n=JSON.parse(localStorage.getItem("excludeCategories")),o=localStorage.getItem("dateFilter");null!==a&&a.forEach(function(e){return t("addToExcludeTypes",e)}),null!==n&&n.forEach(function(e){return t("addToExcludeCategories",e)}),null!==o&&t("setDateFilter",o)},resetDisplayFilters:function(e){(0,e.commit)("clearDisplayFilters"),localStorage.setItem("excludeTypes","[]"),localStorage.setItem("excludeCategories","[]"),localStorage.setItem("dateFilter","ALL_TIME")}}},we={state:{name:"",url:"",logs:[],assets:[],areas:[],currentLogIndex:0,photoLoc:"",geolocation:{},localArea:[],units:[],categories:[],equipment:[]},mutations:{changeFarmName:function(e,t){e.name=t},changeFarmUrl:function(e,t){e.url=t},addLogs:function(e,t){e.logs=e.logs.concat(t)},addAssets:function(e,t){e.assets=e.assets.concat(t)},addAreas:function(e,t){e.areas=e.areas.concat(t)},addUnits:function(e,t){e.units=e.units.concat(t)},addCategories:function(e,t){e.categories=e.categories.concat(t)},addEquipment:function(e,t){e.equipment=e.equipment.concat(t)},updateUnitsFromCache:function(e,t){e.units=e.units.concat(t)},updateCategoriesFromCache:function(e,t){e.categories=e.categories.concat(t)},updateEquipmentFromCache:function(e,t){e.equipment=e.equipment.concat(t)},addLogAndMakeCurrent:function(e,t){e.currentLogIndex=e.logs.push(t)-1},addLogFromServer:function(e,t){var a=e.logs.push(t)-1;this.dispatch("serverLogToDb",{index:a,log:t})},setCurrentLogIndex:function(e,t){e.currentLogIndex=t},updateCurrentLog:function(e,t){var a=ve.create(oe()({},e.logs[e.currentLogIndex],t));e.logs.splice(e.currentLogIndex,1,a)},updateLogFromServer:function(e,t){e.logs.splice(t.index,1,t.log)},updateAllLogs:function(e,t){e.logs=e.logs.map(function(e){return t(e)})},updateLogs:function(e,t){t.indices.map(function(a){return e.logs.splice(a,1,t.mapper(e.logs[a]))})},updateAsset:function(e,t){var a=e.assets.findIndex(function(e){return e.id===t.id});e.assets.splice(a,1,t)},updateArea:function(e,t){var a=e.areas.findIndex(function(e){return e.id===t.id});e.areas.splice(a,1,t)},deleteLog:function(e,t){var a=t.index;e.logs.splice(a,1)},deleteAllAssets:function(e){e.assets=[]},deleteAllAreas:function(e){e.areas=[]},deleteAllUnits:function(e){e.units=[]},deleteAllCategories:function(e){e.categories=[]},deleteAllEquipment:function(e){e.equipment=[]},clearLogs:function(e){e.logs.splice(0,e.logs.length)},clearAssets:function(e){e.assets.splice(0,e.assets.length)},clearAreas:function(e){e.areas.splice(0,e.areas.length)},clearUnits:function(e){e.units.splice(0,e.units.length)},clearCategories:function(e){e.categories.splice(0,e.categories.length)},clearEquipment:function(e){e.equipment.splice(0,e.equipment.length)},setPhotoLoc:function(e,t){e.photoLoc=t},setGeoloc:function(e,t){e.geolocation=t},addLocalArea:function(e,t){e.localArea.push(t)},clearLocalArea:function(e){e.localArea=[]}},actions:{initializeLog:function(e,t){var a=e.commit,n=new Date,o=Math.floor(n/1e3).toString(),r=n.toLocaleTimeString("en-US"),s=n.toLocaleDateString("en-US");a("addLogAndMakeCurrent",ve.create({type:{data:t,changed:o},name:{data:s+" - "+r,changed:o},timestamp:{data:o,changed:o}}))},forceSyncAssetsAndAreas:function(){},getLogs:function(){},serverLogToDb:function(){},onLogsComponentCreated:function(){}}},be=new r.a.Store({modules:{shell:Ce,farm:we,geo:_e}}),Le=a("kiQV"),xe={name:"App",components:{IconMenu:L,IconArrowBack:I},data:function(){return{showDrawer:!1,version:Le.a}},computed:Object(r.b)({errors:function(e){return e.shell.errors},username:function(e){return e.shell.user.name},isLoggedIn:function(e){return e.shell.user.isLoggedIn},useGeolocation:function(e){return e.shell.settings.useGeolocation},farmName:function(e){return e.farm.name},farmUrl:function(e){return""===e.farm.url?"example.farmos.net":e.farm.url}}),watch:{showDrawer:function(e){e?document.querySelector("body").setAttribute("style","overflow-y: hidden"):document.querySelector("body").setAttribute("style","overflow-y: visible")}},methods:{closeError:function(e){this.$store.commit("dismissError",e)},setUseGeolocation:function(e){this.$store.commit("setUseGeolocation",e)}}},ke=(a("hZfW"),Object(i.a)(xe,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"html",attrs:{id:"app"}},[a("transition",{attrs:{name:"filter"}},[e.showDrawer?a("div",{staticClass:"modal-filter",on:{click:function(t){e.showDrawer=!e.showDrawer}}}):e._e()]),e._v(" "),a("transition",{attrs:{name:"drawer"}},[e.showDrawer?a("div",{staticClass:"drawer container-fluid"},[a("header",{staticClass:"drawer-header row"},[a("div",{staticClass:"col"},[a("div",{staticClass:"arrow-back",on:{click:function(t){e.showDrawer=!e.showDrawer}}},[a("icon-arrow-back")],1),e._v(" "),e.isLoggedIn?a("div",{staticClass:"user-info"},[a("h2",[e._v(e._s(e.farmName))]),e._v(" "),a("p",[e._v(e._s(e.farmUrl.replace(/(^\w+:|^)\/\//,"")))]),e._v(" "),a("p",[e._v(e._s(e.username))])]):a("div",{staticClass:"user-info"},[a("h2",[e._v("Welcome to farmOS")]),e._v(" "),a("p",[e._v("Login for more options.")])])])]),e._v(" "),a("ul",{staticClass:"row list-group",on:{click:function(t){e.showDrawer=!e.showDrawer}}},[a("router-link",{attrs:{to:{name:"logs"}}},[a("li",{staticClass:"list-group-item"},[e._v("My Logs")])]),e._v(" "),a("router-link",{attrs:{to:{name:"edit-log",params:{type:"farm_activity"}}}},[a("li",{staticClass:"list-group-item"},[e._v("New Activity")])]),e._v(" "),a("router-link",{attrs:{to:{name:"edit-log",params:{type:"farm_harvest"}}}},[a("li",{staticClass:"list-group-item"},[e._v("New Harvest")])]),e._v(" "),a("router-link",{attrs:{to:{name:"edit-log",params:{type:"farm_input"}}}},[a("li",{staticClass:"list-group-item"},[e._v("New Input")])]),e._v(" "),a("router-link",{attrs:{to:{name:"edit-log",params:{type:"farm_observation"}}}},[a("li",{staticClass:"list-group-item"},[e._v("New Observation")])]),e._v(" "),a("router-link",{attrs:{to:{name:"edit-log",params:{type:"farm_seeding"}}}},[a("li",{staticClass:"list-group-item"},[e._v("New Seeding")])])],1),e._v(" "),a("ul",{staticClass:"row list-group"},[a("li",{staticClass:"list-group-item"},[a("label",{attrs:{for:"location-switch"}},[e._v("Share My Location ")]),e._v(" "),a("input",{staticClass:"toggle-check",attrs:{id:"location-switch",type:"checkbox"},domProps:{checked:e.useGeolocation},on:{input:function(t){return e.setUseGeolocation(t.target.checked)}}})]),e._v(" "),a("li",{staticClass:"list-group-item"},[e._v("Version: "+e._s(e.version))]),e._v(" "),e.isLoggedIn?e._e():a("router-link",{attrs:{to:"/login"}},[a("li",{staticClass:"list-group-item",on:{click:function(t){e.showDrawer=!e.showDrawer}}},[e._v("Login")])]),e._v(" "),e.isLoggedIn?a("router-link",{attrs:{to:"/logout"}},[a("li",{staticClass:"list-group-item",on:{click:function(t){e.showDrawer=!e.showDrawer}}},[e._v("Logout")])]):e._e()],1)]):e._e()]),e._v(" "),a("main",[a("section",[e._l(e.errors,function(t,n){return a("div",{key:"err-"+e.errors.indexOf(t)},[t.show?a("div",{staticClass:"alert alert-warning alert-dismissable"},[a("span",{domProps:{innerHTML:e._s(t.message)}}),e._v(" "),a("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close"},on:{click:function(t){return e.closeError(n)}}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])])]):e._e()])}),e._v(" "),a("div",{staticClass:"region region-content"},[a("div",{staticClass:"block block-system"},[a("router-view",{attrs:{useGeolocation:e.useGeolocation},on:{toggleDrawer:function(t){e.showDrawer=!e.showDrawer}}})],1)])],2)])],1)},[],!1,null,"509f5282",null).exports);a("qQ/H"),a("oGNR");n.a.config.productionTip=!1;var Ie=a("4d7F"),Se=a.n(Ie),Ae={actions:{getPhotoLoc:function(e){var t=e.commit,a=e.rootState;new Se.a(function(e,t){var a={quality:50,destinationType:Camera.DestinationType.DATA_URL};navigator.camera.getPicture(function(t){e(t)},function(e){t(e)},a)}).then(function(e){var n=a.farm.logs[a.farm.currentLogIndex],o="data:image/jpeg;base64,"+e,r=(Date.now()/1e3).toFixed(0),s={images:{data:n.images.data.concat(o),changed:r},isCachedLocally:!1,wasPushedToServer:!1};t("updateCurrentLog",s)},function(e){})},loadPhotoBlob:function(e,t){var a=e.commit,n=e.rootState,o=n.farm.logs[n.farm.currentLogIndex],r=(Date.now()/1e3).toFixed(0);(function(e){return new Se.a(function(t,a){var n=new FileReader;n.onloadend=function(){return t(n.result)},n.onerror=function(){return a(n.error)},n.readAsDataURL(e)})})(t).then(function(e){var t={images:{data:o.images.data.concat(e),changed:r},isCachedLocally:!1,wasPushedToServer:!1};a("updateCurrentLog",t)})}}};var Ee={install:function(e,t){t.store.registerModule("camera",Ae)}},je=a("sk9p"),De={version:1,name:"farmos",stores:[{name:"logs",keyPath:"local_id",autoIncrement:!0},{name:"assets",keyPath:"id",autoIncrement:!1},{name:"areas",keyPath:"tid",autoIncrement:!1},{name:"units",keyPath:"tid",autoIncrement:!1},{name:"categories",keyPath:"tid",autoIncrement:!1},{name:"equipment",keyPath:"id",autoIncrement:!1}]};function Te(){return new Se.a(function(e,t){var a=indexedDB.open(De.name,De.version);a.onerror=function(e){return t(e.target.errorcode)},a.onsuccess=function(){return e(a.result)},a.onupgradeneeded=function(e){var t=e.currentTarget.result;De.stores.forEach(function(e){var a=e.name,n=e.keyPath,o=e.autoIncrement;t.createObjectStore(a,{keyPath:n,autoIncrement:o})})}})}function Oe(e,t){return new Se.a(function(a,n){var o=e.transaction(t,"readonly").objectStore(t).getAll();o.onerror=function(e){return n(e.target)},o.onsuccess=function(e){return a(e.target.result)}})}function Fe(e,t,a){return new Se.a(function(n,o){var r=e.transaction(t,"readwrite").objectStore(t).put(a);r.onerror=function(e){return o(new Error(e.target.errorcode))},r.onsuccess=function(e){return n(e.target.result)}})}function Me(e,t){return new Se.a(function(a,n){var o=e.transaction(t,"readwrite").objectStore(t).clear();o.onsuccess=function(e){return a(e.target.result)},o.onerror=function(e){return n(e.error)}})}var Ue=a.n(je)()(De.stores,6),$e=Ue[0],qe=Ue[1],Pe=Ue[2],Ne=Ue[3],ze=Ue[4],Re=Ue[5],Ge={actions:{createCachedLog:function(e,t){var a=e.commit,n=ve.toIdb(t);Te().then(function(e){return Fe(e,$e.name,n)}).then(function(e){return a("updateCurrentLog",{local_id:e,isCachedLocally:!0})})},createLogFromServer:function(e,t){var a=e.commit,n=t.index,o=t.log,r=ve.toIdb(o);Te().then(function(e){return Fe(e,$e.name,r)}).then(function(e){a("updateLogFromServer",{index:n,log:ve.create(oe()({},o,{local_id:e,isCachedLocally:!0}))})})},loadCachedLogs:function(e){var t=e.commit;Te().then(function(e){return Oe(e,$e.name)}).then(function(e){var a=e.map(function(e){return ve.create(oe()({},e,{isCachedLocally:!0}))});t("addLogs",a)}).catch(console.error)},updateCachedLog:function(e,t){var a=e.commit,n=e.rootState,o=ve.toIdb(oe()({},n.farm.logs[n.farm.currentLogIndex],t));Te().then(function(e){return Fe(e,$e.name,o)}).then(function(e){return a("updateCurrentLog",{isCachedLocally:!0,local_id:e})})},updateCachedLogAtIndex:function(e,t){var a=e.commit,n=e.rootState,o=t.log,r=t.index,s=ve.toIdb(oe()({},n.farm.logs[r],o));Te().then(function(e){return Fe(e,$e.name,s)}).then(function(e){return a("updateLogFromServer",{index:r,log:ve.create(oe()({},o,{isCachedLocally:!0,local_id:e}))})})},deleteCachedLog:function(e,t){var a=t.local_id;Te().then(function(e){return function(e,t,a){return new Se.a(function(n,o){var r=e.transaction(t,"readwrite").objectStore(t).delete(a);r.onsuccess=function(e){return n(e.target.result)},r.onerror=function(e){return o(e.error)}})}(e,$e.name,a)}).catch(console.error)},deleteAllCachedLogs:function(){Te().then(function(e){return Me(e,$e.name)}).catch(console.error)},createCachedAsset:function(e,t){Te().then(function(e){return Fe(e,qe.name,t)}).catch(console.error)},updateCachedAsset:function(e,t){Te().then(function(e){return Fe(e,qe.name,t)}).catch(console.error)},deleteAllCachedAssets:function(){Te().then(function(e){return Me(e,qe.name)}).catch(console.error)},loadCachedAssets:function(e){var t=e.commit;Te().then(function(e){return Oe(e,qe.name)}).then(function(e){t("addAssets",e)}).catch(console.error)},createCachedArea:function(e,t){Te().then(function(e){return Fe(e,Pe.name,t)}).catch(console.error)},updateCachedArea:function(e,t){Te().then(function(e){return Fe(e,Pe.name,t)}).catch(console.error)},deleteAllCachedAreas:function(){Te().then(function(e){return Me(e,Pe.name)}).catch(console.error)},loadCachedAreas:function(e){var t=e.commit;Te().then(function(e){return Oe(e,Pe.name)}).then(function(e){t("addAreas",e)}).catch(console.error)},createCachedUnit:function(e,t){Te().then(function(e){return Fe(e,Ne.name,t)}).catch(console.error)},updateCachedUnit:function(e,t){Te().then(function(e){return Fe(e,Ne.name,t)}).catch(console.error)},deleteAllCachedUnits:function(){Te().then(function(e){return Me(e,Ne.name)}).catch(console.error)},loadCachedUnits:function(e){var t=e.commit;Te().then(function(e){return Oe(e,Ne.name)}).then(function(e){t("updateUnitsFromCache",e)}).catch(console.error)},createCachedCategory:function(e,t){Te().then(function(e){return Fe(e,ze.name,t)}).catch(console.error)},updateCachedCategory:function(e,t){Te().then(function(e){return Fe(e,ze.name,t)}).catch(console.error)},deleteAllCachedCategories:function(){Te().then(function(e){return Me(e,ze.name)}).catch(console.error)},loadCachedCategories:function(e){var t=e.commit;Te().then(function(e){return Oe(e,ze.name)}).then(function(e){t("updateCategoriesFromCache",e)}).catch(console.error)},createCachedEquipment:function(e,t){Te().then(function(e){return Fe(e,Re.name,t)}).catch(console.error)},updateCachedEquipment:function(e,t){Te().then(function(e){return Fe(e,Re.name,t)}).catch(console.error)},deleteAllCachedEquipment:function(){Te().then(function(e){return Me(e,Re.name)}).catch(console.error)},loadCachedEquipment:function(e){var t=e.commit;Te().then(function(e){return Oe(e,Re.name)}).then(function(e){t("addEquipment",e)}).catch(console.error)}}},Be={install:function(e,t){var a=t.store;a.registerModule("idb",Ge),a.subscribeAction(function(e){"onLogsComponentCreated"===e.type&&(a.dispatch("loadCachedUserAndSiteInfo"),a.commit("clearLogs"),a.commit("clearAssets"),a.commit("clearAreas"),a.commit("clearUnits"),a.commit("clearCategories"),a.commit("clearEquipment"),a.dispatch("loadCachedLogs"),a.dispatch("loadCachedAssets"),a.dispatch("loadCachedAreas"),a.dispatch("loadCachedUnits"),a.dispatch("loadCachedCategories"),a.dispatch("loadCachedEquipment"))}),a.subscribe(function(e){"addLogAndMakeCurrent"===e.type&&a.dispatch("createCachedLog",e.payload),"updateCurrentLog"!==e.type||JSON.parse(e.payload.isCachedLocally)||a.dispatch("updateCachedLog",e.payload),"updateLogFromServer"!==e.type||JSON.parse(e.payload.log.isCachedLocally)||a.dispatch("updateCachedLogAtIndex",e.payload),"updateLogs"===e.type&&e.payload.indices.forEach(function(e){a.dispatch("updateCachedLog",a.state.farm.logs[e])}),"deleteLog"===e.type&&a.dispatch("deleteCachedLog",e.payload),"addAssets"===e.type&&e.payload.forEach(function(e){a.dispatch("createCachedAsset",e)}),"updateAsset"===e.type&&a.dispatch("updateCachedAsset",e.payload),"deleteAllAssets"===e.type&&a.dispatch("deleteAllCachedAssets"),"addAreas"===e.type&&e.payload.forEach(function(e){a.dispatch("createCachedArea",e)}),"updateArea"===e.type&&a.dispatch("updateCachedArea",e.payload),"deleteAllAreas"===e.type&&a.dispatch("deleteAllCachedAreas"),"addUnits"===e.type&&e.payload.forEach(function(e){a.dispatch("createCachedUnit",e)}),"deleteAllUnits"===e.type&&a.dispatch("deleteAllCachedUnits"),"addCategories"===e.type&&e.payload.forEach(function(e){a.dispatch("createCachedCategory",e)}),"deleteAllCategories"===e.type&&a.dispatch("deleteAllCachedCategories"),"addEquipment"===e.type&&e.payload.forEach(function(e){a.dispatch("createCachedEquipment",e)}),"deleteAllEquipment"===e.type&&a.dispatch("deleteAllCachedEquipment"),"setUseGeolocation"===e.type&&localStorage.setItem("useGeolocation",e.payload)})}},He=a("Yz+Y"),Ye=a.n(He),Ve=a("iCc5"),Qe=a.n(Ve),Je=a("FYw3"),We=a.n(Je),Ke=a("mRg0"),Xe=a.n(Ke),Ze=a("vzJi"),et=a.n(Ze),tt=function(){var e=localStorage.getItem("host"),t=localStorage.getItem("username"),a=localStorage.getItem("password");return et()(e,t,a)},at=function(e){function t(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=a.indices,o=void 0===n?[]:n,r=a.http;Qe()(this,t);for(var s=arguments.length,i=Array(s>1?s-1:0),c=1;c<s;c++)i[c-1]=arguments[c];var l=We()(this,(e=t.__proto__||Ye()(t)).call.apply(e,[this].concat(i)));return l.name="SyncError",l.indices=o,l.http=r,l}return Xe()(t,e),t}(Error),nt={actions:{updateAreas:function(e){var t=e.commit;return tt().area.get().then(function(e){t("deleteAllAreas");var a=e.list.map(function(e){return{tid:e.tid,name:e.name,geofield:e.geofield}});t("addAreas",a)})},updateAssets:function(e){var t=e.commit;return tt().asset.get().then(function(e){t("deleteAllAssets");var a=e.list.map(function(e){return{id:e.id,name:e.name,type:e.type}});t("addAssets",a)})},updateUnits:function(e){var t=e.commit;return tt().term.get("farm_quantity_units").then(function(e){t("deleteAllUnits");var a=e.list.map(function(e){return{tid:e.tid,name:e.name}});t("addUnits",a)})},updateCategories:function(e){var t=e.commit;return tt().term.get("farm_log_categories").then(function(e){t("deleteAllCategories");var a=e.list.map(function(e){return{tid:e.tid,name:e.name}});t("addCategories",a)})},updateEquipment:function(e){var t=e.commit;return tt().asset.get().then(function(e){t("deleteAllEquipment");var a=function(e){var t=[];return e.forEach(function(e){"equipment"===e.type&&t.push(e)}),t}(e.list.map(function(e){return{id:e.id,name:e.name,type:e.type}}));t("addEquipment",a)})},sendLogs:function(e,t){var a=e.commit,n=e.rootState;t.forEach(function(e){var t=ve.toServer(n.farm.logs[e]);tt().log.send(t,localStorage.getItem("token")).then(function(t){return function(e,t){a("updateLogs",{indices:[t],mapper:function(t){return ve.create(oe()({},t,{id:e.id,wasPushedToServer:!0,isReadyToSync:!1,remoteUri:e.uri}))}})}(t,e)}).catch(function(t){throw new at({indices:[e],http:t})})})},getServerLogs:function(e){var t=e.commit,a=e.rootState,n=localStorage.getItem("syncDate"),o=a.farm.logs;return tt().log.get(a.shell.settings.logImportFilters).then(function(e){return e.list.map(function(e){var a=ot(e,o,n);if(a.serverChange){var r=rt(e,a,n);t("updateLogFromServer",{index:a.storeIndex,log:r})}if(null===a.localId){var s=rt(e,a,n);t("addLogFromServer",s)}return e.id})}).then(function(e){var t=o.filter(function(t){return t.id&&!e.some(function(e){return t.id===e})}).map(function(e){return e.id});return tt().log.get(t)}).then(function(e){e.list.forEach(function(e){var a=ot(e,o,n);if(a.serverChange){var r=rt(e,a,n);t("updateLogFromServer",{index:a.storeIndex,log:r})}})}).catch(function(e){throw new at({http:e})})}}};function ot(e,t,a){var n={localId:null,storeIndex:null,localChange:!0,serverChange:!1,log:null};return t.forEach(function(t,o){t.id&&t.id===e.id&&(n.localId=t.local_id,n.storeIndex=o,!0===JSON.parse(t.wasPushedToServer)?n.localChange=!1:n.log=t,+e.changed>+a&&(n.serverChange=!0))}),n}function rt(e,t,a){if(null===t.localId)return ve.fromServer(oe()({},e,{wasPushedToServer:!0,isReadyToSync:!1,done:1===parseInt(e.done,10)}));if(!t.localChange&&t.serverChange)return ve.fromServer(oe()({},e,{wasPushedToServer:!0,isReadyToSync:!1,local_id:t.localId,done:1===parseInt(e.done,10)}));var n=t.log,o={},r={},s=ve.fromServer(e);return se()(n).forEach(function(e){n[e].changed&&null!==n[e].changed&&(+n[e].changed<+a?o[e]=s[e]:r[e]=n[e])}),ve.toStore(oe()({},r,o,{wasPushedToServer:!1,local_id:t.localId,id:e.id,done:{changed:Math.floor(Date.now()/1e3),data:1==+e.done},isReadyToSync:!0}))}function st(e,t,a){return void 0!==t.isReadyToSync&&JSON.parse(t.isReadyToSync)&&!JSON.parse(t.wasPushedToServer)?e.concat(a):e}var it,ct,lt={install:function(e,t){var a=t.store,n=t.router;function o(e){a.commit("updateAllLogs",function(e){return oe()({},e,{isReadyToSync:!1})});var t=e.indices.length>0?e.indices.reduce(function(e,t){return e+', "'+a.state.farm.logs[t]+'"'},""):"";if(void 0===e.http.response){var o={message:"Unable to sync "+t+" because the network is currently unavailable. Please try syncing again later.",level:"warning",show:!0};a.commit("logError",o)}else if(401===e.http.response.status||403===e.http.response.status||404===e.http.response.status)n.push("/login");else{var r={message:e.http.response.status+' error while syncing "'+t+'": '+e.http.response.statusText,errorCode:e.http.response.statusText,level:"warning",show:!0};a.commit("logError",r)}}a.registerModule("http",nt),a.subscribeAction({after:function(e){if("forceSyncAssetsAndAreas"===e.type){if(null!==localStorage.getItem("host"))return a.dispatch("updateAssets"),void a.dispatch("updateAreas");n.push("/login")}"getLogs"===e.type&&(localStorage.getItem("token")?(a.commit("updateAllLogs",function(e){return oe()({},e,{isReadyToSync:!0})}),a.dispatch("getServerLogs").then(function(){localStorage.setItem("syncDate",(Date.now()/1e3).toFixed(0));var e=a.state.farm.logs.reduce(st,[]);a.dispatch("sendLogs",e)}).catch(o)):n.push("/login")),"serverLogToDb"===e.type&&a.dispatch("createLogFromServer",e.payload),"loadCachedAssets"===e.type&&a.dispatch("updateAssets"),"loadCachedAreas"===e.type&&a.dispatch("updateAreas"),"sendLogs"===e.type&&a.dispatch("updateUnits").then(a.dispatch("updateCategories")).then(a.dispatch("updateEquipment"))}})}},ut={components:{iconSpinner:$},name:"Login",data:function(){return{valuesEntered:!1,authPending:!1,username:"",password:"",farmosUrl:""}},methods:{checkValues:function(){var e=""!==this.username,t=""!==this.username,a=""!==this.password;e&&t&&a&&(this.valuesEntered=!0)},submitCredentials:function(){var e=this,t={farmosUrl:this.farmosUrl,username:this.username,password:this.password,router:this.$router};this.authPending=!0,this.$store.dispatch("didSubmitCredentials",t).then(function(){e.authPending=!1,e.$store.commit("setLoginStatus",!0),e.$store.dispatch("updateUserAndSiteInfo")})},onDeviceReady:function(){this.loadUserInfo()},loadUserInfo:function(){this.farmosUrl=window.localStorage.getItem("host").replace(/(^\w+:|^)\/\//,""),this.username=window.localStorage.getItem("username"),this.password=window.localStorage.getItem("password"),this.checkValues()}},created:function(){document.addEventListener("deviceready",this.onDeviceReady(),!1),this.loadUserInfo()}},dt=(a("OITN"),Object(i.a)(ut,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"login"}},[a("div",{staticClass:"input-group"},[e._m(0),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.farmosUrl,expression:"farmosUrl"}],staticClass:"form-control",attrs:{placeholder:"Enter your farmOS URL",autofocus:"",type:"url",autocomplete:"url"},domProps:{value:e.farmosUrl},on:{input:[function(t){t.target.composing||(e.farmosUrl=t.target.value)},e.checkValues]}})]),e._v(" "),a("br"),e._v(" "),a("div",{staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],staticClass:"form-control",attrs:{placeholder:"Enter your username",type:"text",autocomplete:"username"},domProps:{value:e.username},on:{input:[function(t){t.target.composing||(e.username=t.target.value)},e.checkValues]}})]),e._v(" "),a("br"),e._v(" "),a("div",{staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control",attrs:{placeholder:"Enter your password",type:"password",autocomplete:"current-password"},domProps:{value:e.password},on:{input:[function(t){t.target.composing||(e.password=t.target.value)},e.checkValues]}})]),e._v(" "),a("br"),e._v(" "),a("div",{staticClass:"input-group login-submit"},[e.authPending?a("div",[a("icon-spinner")],1):a("button",{staticClass:"btn btn-success btn-navbar",attrs:{disabled:!this.valuesEntered,title:"Submit credentials",type:"button"},on:{click:e.submitCredentials}},[e._v("\n      Submit credentials\n    ")])]),e._v(" "),a("br"),e._v(" "),e._m(1)])},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"input-group-prepend"},[t("span",{staticClass:"input-group-text"},[this._v("https://")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Need a server? Check out "),t("a",{attrs:{href:"https://farmos.org/hosting/"}},[this._v("hosting options")]),this._v(".")])}],!1,null,"00657035",null).exports),mt={name:"Logout",methods:{goBack:function(){this.$router.back()},logout:function(){this.$store.dispatch("logout"),this.$store.commit("clearLogs"),this.$store.commit("clearAssets"),this.$store.commit("clearAreas"),this.$store.commit("changeUsername",""),this.$store.commit("changeEmail",""),this.$store.commit("changeUid",""),this.$store.commit("changeFarmName",""),this.$store.commit("changeFarmUrl",""),this.$store.dispatch("deleteAllCachedLogs"),this.$store.dispatch("deleteAllCachedAssets"),this.$store.dispatch("deleteAllCachedAreas"),this.$store.dispatch("deleteAllCachedUnits"),this.$store.dispatch("deleteAllCachedEquipment"),this.$store.dispatch("deleteAllCachedCategories"),this.$store.dispatch("deleteCachedUserAndSiteInfo"),this.$store.commit("setLoginStatus",!1),this.$router.push({path:"/login"})}}},ht=(a("+Ajr"),Object(i.a)(mt,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container-fluid"},[this._m(0),this._v(" "),t("div",{staticClass:"row justify-content-sm-center"},[t("div",{staticClass:"col col-sm-auto",attrs:{id:"go-back"}},[t("button",{staticClass:"btn btn-lg btn-success",attrs:{type:"button",name:"button"},on:{click:this.goBack}},[this._v("\n        Go Back\n      ")])]),this._v(" "),t("div",{staticClass:"col col-sm-auto"},[t("button",{staticClass:"btn btn-lg btn-primary",attrs:{type:"button",name:"button"},on:{click:this.logout}},[this._v("\n        Logout\n      ")])])])])},[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"row",attrs:{id:"first-row"}},[t("div",{staticClass:"col"},[t("div",{staticClass:"card text-primary border-primary mb-3"},[t("div",{staticClass:"card-body"},[t("h4",{staticClass:"card-title"},[this._v("WARNING!")]),this._v(" "),t("p",{staticClass:"card-text"},[this._v("\n            Logging out will permanently delete all logs stored on this device.\n            You will not be able to recover logs which have not been synced with\n            your farmOS server. Go back to sync any unsaved logs, or proceed to\n            logout and clear all data from this device.\n          ")])])])])])}],!1,null,"f0c44152",null).exports),gt=function(){var e=localStorage.getItem("host"),t=localStorage.getItem("username"),a=localStorage.getItem("password");return et()(e,t,a)},pt={actions:{didSubmitCredentials:function(e,t){var a=e.commit,n="https://"+t.farmosUrl,o=t.username,r=t.password,s=t.router,i=window.localStorage;return new Se.a(function(e){et()(n,o,r).authenticate().then(function(t){if(i.setItem("host",n),i.setItem("username",o),i.setItem("password",r),i.setItem("token",t),window.history.length>1)return window.history.back(),void e();s.push("/"),e()}).catch(function(){var c="http://"+t.farmosUrl;et()(c,o,r).authenticate().then(function(t){if(i.setItem("host",c),i.setItem("username",o),i.setItem("password",r),i.setItem("token",t),window.history.length>1)return window.history.back(),void e();s.push("/"),e()}).catch(function(t){!function(e){if(403===e.status){var t={message:'The username or password you entered was incorrect. Please try again, or <a href="'+n+'/user/password">reset your password</a>.',errorCode:e.statusText,level:"warning",show:!0};a("logError",t)}else{var o={message:"Unable to reach the server. Please check that you have the correct URL and that your device has a network connection. Status: "+e.message,errorCode:e.statusText,level:"warning",show:!0};a("logError",o)}}(t),e()})})})},logout:function(){gt().logout().then(function(){})},updateUserAndSiteInfo:function(e){var t=e.commit;localStorage.getItem("username")&&gt().info().then(function(e){t("changeFarmName",e.name),t("changeFarmUrl",e.url),t("changeUsername",e.user.name),t("changeEmail",e.user.mail),t("changeUid",e.user.uid),t("setLoginStatus",!0),localStorage.setItem("farmName",e.name),localStorage.setItem("username",e.user.name),localStorage.setItem("email",e.user.mail),localStorage.setItem("uid",e.user.uid),localStorage.setItem("isLoggedIn",!0)})},loadCachedUserAndSiteInfo:function(e){var t=e.commit;t("changeUsername",localStorage.getItem("username")),t("changeEmail",localStorage.getItem("email")),t("changeUid",localStorage.getItem("uid")),t("setLoginStatus",localStorage.getItem("isLoggedIn")),t("changeFarmName",localStorage.getItem("farmName")),t("changeFarmUrl",localStorage.getItem("host")),localStorage.getItem("useGeolocation")&&("true"===localStorage.getItem("useGeolocation")?t("setUseGeolocation",!0):t("setUseGeolocation",!1))},deleteCachedUserAndSiteInfo:function(){localStorage.clear()}}};it="#app",void 0!==(ct=[Ee,Be,lt,{install:function(e,t){var a=t.router,n=t.store,o=e.component(dt.name,dt),r=e.component(ht.name,ht);a.addRoutes([{path:"/login",name:"Login",component:o},{path:"/logout",name:"Logout",component:r}]),a.beforeEach(function(e,t,a){"/login"===t.path&&"/logout"===e.path&&a("/"),a()}),n.registerModule("auth",pt)}}])&&ct.length>0&&ct.forEach(function(e){return n.a.use(e,{store:be,router:ae})}),new n.a({el:it,store:be,router:ae,components:{App:ke},template:"<App/>"}),"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/service-worker.js")})},b3WB:function(e,t,a){"use strict";var n=a("bq/y");a.n(n).a},"bq/y":function(e,t,a){},hZfW:function(e,t,a){"use strict";var n=a("Knie");a.n(n).a},j3JQ:function(e,t,a){"use strict";var n=a("mt3h");a.n(n).a},kiQV:function(e){e.exports={a:"0.4.7"}},mRpm:function(e,t,a){"use strict";var n=a("JQmY");a.n(n).a},mt3h:function(e,t,a){},nldY:function(e,t,a){"use strict";var n=a("RyYm");a.n(n).a},oGNR:function(e,t,a){},"qQ/H":function(e,t,a){},rTSf:function(e,t,a){"use strict";var n=a("9qtH");a.n(n).a}});